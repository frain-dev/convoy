"use strict";(self.webpackChunkconvoy_ng=self.webpackChunkconvoy_ng||[]).push([[557],{4341:(y,f,a)=>{a.d(f,{q:()=>h});var u=a(7073),s=a(4151);let h=(()=>{class c{}return c.\u0275fac=function(d){return new(d||c)},c.\u0275mod=s.oAB({type:c}),c.\u0275inj=s.cJS({imports:[u.ez]}),c})()},6440:(y,f,a)=>{a.d(f,{i:()=>d});var u=a(9369),s=a(4151),h=a(3755),c=a(7205),g=a(7590);let d=(()=>{class p{constructor(t,r,n){this.http=t,this.router=r,this.projectService=n,this.projects=[],this.showCreateOrgModal=!1}getOrganisation(){let t=localStorage.getItem("CONVOY_ORG");return t?JSON.parse(t):null}urlFactory(t){const r=this.getOrganisation().uid;switch(t){case"org":return`/organisations/${r}`;case"org_project":return`/organisations/${r}/projects/${this.activeProjectDetails?.uid}`;default:return""}}getConfiguration(){var t=this;return new Promise(function(){var r=(0,u.Z)(function*(n,o){if(t.configutation)return n(t.configutation);try{const e=yield t.http.request({url:"/configuration",method:"get"});return t.configutation=e,n(e)}catch(e){return o(e)}});return function(n,o){return r.apply(this,arguments)}}())}deleteSubscription(t){var r=this;return new Promise(function(){var n=(0,u.Z)(function*(o,e){try{return o(yield r.http.request({url:`/subscriptions/${t}`,method:"delete",level:"org_project"}))}catch(i){return e(i)}});return function(o,e){return n.apply(this,arguments)}}())}getSubscriptions(t){var r=this;return new Promise(function(){var n=(0,u.Z)(function*(o,e){try{return t||(t={next_page_cursor:String(Number.MAX_SAFE_INTEGER),direction:"next"}),o(yield r.http.request({url:"/subscriptions",method:"get",level:"org_project",query:t}))}catch(i){return e(i)}});return function(o,e){return n.apply(this,arguments)}}())}getProjectDetails(t){var r=this;const n=this.router.url.split("/")[2];return new Promise(function(){var o=(0,u.Z)(function*(e,i){if(r.projectDetails&&!t?.refresh)return e(r.projectDetails);try{const l=yield r.http.request({url:`/projects/${t?.projectId||r.activeProjectDetails?.uid||n}`,method:"get",level:"org"});return r.activeProjectDetails=l.data,r.projectService.activeProjectDetails=l.data,r.projectDetails=l,e(l)}catch(l){return i(l)}});return function(e,i){return o.apply(this,arguments)}}())}organisationConfig(t){var r=this;return(0,u.Z)(function*(){if(!t||t&&0==t?.length)return;const n=localStorage.getItem("CONVOY_ORG");if(!n||"undefined"===n)return;const o=JSON.parse(n),e=t.find(i=>i.uid===o?.uid);if(e)return localStorage.setItem("CONVOY_ORG",JSON.stringify(e));r.organisationDetails=t[0],localStorage.setItem("CONVOY_ORG",JSON.stringify(t[0]))})()}getOrganizations(t){var r=this;return new Promise(function(){var n=(0,u.Z)(function*(o,e){if(r.organisations&&!t?.refresh)return o(r.organisations);try{const i=yield r.http.request({url:"/organisations",method:"get"});return yield r.organisationConfig(i.data?.content),r.organisations=i,i.data.content.length?o(i):r.router.navigateByUrl("/get-started")}catch(i){return e(i)}});return function(o,e){return n.apply(this,arguments)}}())}logout(){var t=this;return new Promise(function(){var r=(0,u.Z)(function*(n,o){try{return n(yield t.http.request({url:"/auth/logout",method:"post",body:null}))}catch(e){return o(e)}});return function(n,o){return r.apply(this,arguments)}}())}addOrganisation(t){var r=this;return new Promise(function(){var n=(0,u.Z)(function*(o,e){try{return o(yield r.http.request({url:"/organisations",method:"post",body:t}))}catch(i){return e(i)}});return function(o,e){return n.apply(this,arguments)}}())}getProjects(){var t=this;return new Promise(function(){var r=(0,u.Z)(function*(n,o){try{const e=yield t.http.request({url:"/projects",method:"get",level:"org"});return t.projects=e.data,n(e)}catch(e){return o(e)}});return function(n,o){return r.apply(this,arguments)}}())}flipt(){var t=this;let r;if(this.organisationDetails?.uid)r=this.organisationDetails?.uid;else{const n=localStorage.getItem("CONVOY_ORG");n&&(r=JSON.parse(n).uid)}return new Promise(function(){var n=(0,u.Z)(function*(o,e){const l=[];["can_create_cli_api_key"].forEach(_=>l.push({flagKey:_,entityId:_,context:{group_id:t.activeProjectDetails?.uid||"",organisation_id:r}}));try{const _=yield t.http.request({url:"/flags",method:"post",body:{requests:l},hideNotification:!0,isOut:!0});return t.apiFlagResponse=_,o(_)}catch(_){return e(_)}});return function(o,e){return n.apply(this,arguments)}}())}getFlag(t){var r=this;return(0,u.Z)(function*(){try{return r.apiFlagResponse||(yield r.flipt()),!!r.apiFlagResponse?.responses.find(o=>o.flagKey===t)?.match}catch{return!1}})()}getUserDetails(t){var r=this;return new Promise(function(){var n=(0,u.Z)(function*(o,e){if(r.profileDetails&&!t.refresh)return o(r.profileDetails);try{const i=yield r.http.request({url:`/users/${t.userId}/profile`,method:"get"});return r.profileDetails=i,o(i)}catch(i){return e(i)}});return function(o,e){return n.apply(this,arguments)}}())}getEndpoints(t){var r=this;return new Promise(function(){var n=(0,u.Z)(function*(o,e){try{return!t?.next_page_cursor&&!t?.prev_page_cursor&&(t={next_page_cursor:String(Number.MAX_SAFE_INTEGER),direction:"next",q:t?.q}),o(yield r.http.request({url:"/endpoints",method:"get",query:t,level:"org_project"}))}catch(i){return e(i)}});return function(o,e){return n.apply(this,arguments)}}())}getSources(t){var r=this;return new Promise(function(){var n=(0,u.Z)(function*(o,e){try{return t||(t={next_page_cursor:String(Number.MAX_SAFE_INTEGER),direction:"next"}),o(yield r.http.request({url:"/sources",method:"get",level:"org_project",query:t}))}catch(i){return e(i)}});return function(o,e){return n.apply(this,arguments)}}())}getRefreshToken(){var t=this;return(0,u.Z)(function*(){let r=localStorage.CONVOY_AUTH_TOKENS;return r=!!r&&JSON.parse(r),new Promise(function(){var n=(0,u.Z)(function*(o,e){if(!r)return e();try{const i=yield t.http.request({url:"/auth/token/refresh",method:"post",body:r});return localStorage.setItem("CONVOY_AUTH_TOKENS",JSON.stringify(i.data)),o(i)}catch(i){e(i)}});return function(o,e){return n.apply(this,arguments)}}())})()}getProjectStat(t){var r=this;return new Promise(function(){var n=(0,u.Z)(function*(o,e){if(r.projectStats&&!t?.refresh)return o(r.projectStats);try{const i=yield r.http.request({url:"/stats",method:"get",level:"org_project"});return r.projectStats=i,o(i)}catch(i){return e(i)}});return function(o,e){return n.apply(this,arguments)}}())}}return p.\u0275fac=function(t){return new(t||p)(s.LFG(h.O),s.LFG(c.F0),s.LFG(g.Y))},p.\u0275prov=s.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},1778:(y,f,a)=>{a.r(f),a.d(f,{EventDeliveryModule:()=>r});var u=a(7073),s=a(4151),h=a(7205),c=a(5453),g=a(2895);const d=function(n){return{token:n}};let p=(()=>{class n{constructor(e){this.route=e,this.portalToken=this.route.snapshot.queryParams.token}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)(s.Y36(h.gz))},n.\u0275cmp=s.Xpm({type:n,selectors:[["app-event-delivery"]],decls:9,vars:4,consts:[["convoy-page",""],[1,"text-12","font-medium","flex","items-center","mb-24px","uppercase"],[1,"font-medium","cursor-pointer","text-primary-100",3,"routerLink","queryParams"],["width","16","height","16",1,"mx-4px"],[0,"xlink","href","#arrow-right-icon"],[1,"font-medium"]],template:function(e,i){1&e&&(s.TgZ(0,"div",0)(1,"div",1)(2,"a",2),s._uU(3,"Portal"),s.qZA(),s.O4$(),s.TgZ(4,"svg",3),s._UZ(5,"use",4),s.qZA(),s.kcU(),s.TgZ(6,"span",5),s._uU(7,"Event Delivery"),s.qZA()(),s._UZ(8,"app-event-delivery-details"),s.qZA()),2&e&&(s.xp6(2),s.Q6J("routerLink","/portal")("queryParams",s.VKq(2,d,i.portalToken)))},dependencies:[h.yS,c.E,g.i],styles:[".page[_ngcontent-%COMP%]{background:transparent}"]}),n})();var v=a(6997);const t=[{path:"",component:p}];let r=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=s.oAB({type:n}),n.\u0275inj=s.cJS({imports:[u.ez,h.Bz.forChild(t),v.y]}),n})()}}]);
//# sourceMappingURL=557.286593e86716883b.js.map