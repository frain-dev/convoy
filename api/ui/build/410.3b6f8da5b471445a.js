"use strict";(self.webpackChunkconvoy_ng=self.webpackChunkconvoy_ng||[]).push([[410],{7542:(x,g,i)=>{i.d(g,{R:()=>m});var l=i(4151),_=i(7073);const c=function(p){return{"opacity-50":p}};let m=(()=>{class p{constructor(){this.isTransparent=!1,this.position="absolute"}ngOnInit(){}}return p.\u0275fac=function(e){return new(e||p)},p.\u0275cmp=l.Xpm({type:p,selectors:[["convoy-loader"]],inputs:{isTransparent:"isTransparent",position:"position"},decls:2,vars:5,consts:[[3,"ngClass"],["src","/assets/img/page-loader.gif","alt","loader",1,"w-150px"]],template:function(e,f){1&e&&(l.TgZ(0,"div",0),l._UZ(1,"img",1),l.qZA()),2&e&&(l.Tol(f.position+" left-0 right-0 top-0 bottom-0 flex items-center justify-center bg-gradient-radial rounded-8px h-full z-[1]"),l.Q6J("ngClass",l.VKq(3,c,f.isTransparent)))},dependencies:[_.mk]}),p})()},4341:(x,g,i)=>{i.d(g,{q:()=>c});var l=i(7073),_=i(4151);let c=(()=>{class m{}return m.\u0275fac=function(v){return new(v||m)},m.\u0275mod=_.oAB({type:m}),m.\u0275inj=_.cJS({imports:[l.ez]}),m})()},8410:(x,g,i)=>{i.r(g),i.d(g,{AcceptInviteComponent:()=>S});var l=i(9369),_=i(7073),c=i(6907),m=i(1354),p=i(2187),v=i(4341),e=i(4151),f=i(3755);let y=(()=>{class n{constructor(t){this.http=t}acceptInvite(t){var o=this;return new Promise(function(){var s=(0,l.Z)(function*(a,u){try{return a(yield o.http.request({url:`/organisations/process_invite?accepted=true&token=${t.token}`,body:t.body,method:"post"}))}catch(d){return u(d)}});return function(a,u){return s.apply(this,arguments)}}())}getUserDetails(t){var o=this;return new Promise(function(){var s=(0,l.Z)(function*(a,u){try{return a(yield o.http.request({url:`/users/token?token=${t}`,method:"get"}))}catch(d){return u(d)}});return function(a,u){return s.apply(this,arguments)}}())}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(f.O))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var h=i(7205),I=i(4330),A=i(7542);function Z(n,r){1&n&&e._UZ(0,"convoy-loader")}function T(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij("(",t.organisationName,")")}}function b(n,r){if(1&n&&(e.TgZ(0,"p",17),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij("Please fill in your ",t.userDetailsAvailable?"password details below to":"details below to create your account and"," join your team")}}function C(n,r){1&n&&(e.TgZ(0,"convoy-input-error"),e._uU(1,"First name is required"),e.qZA())}function w(n,r){1&n&&(e.TgZ(0,"convoy-input-error"),e._uU(1,"Last name is required"),e.qZA())}function U(n,r){1&n&&(e.TgZ(0,"convoy-input-error"),e._uU(1,"Email is required"),e.qZA())}function F(n,r){1&n&&(e.TgZ(0,"convoy-input-error"),e._uU(1,"Password is required"),e.qZA())}function D(n,r){1&n&&(e.TgZ(0,"div",21),e._UZ(1,"img",22),e.TgZ(2,"span"),e._uU(3,"Password should be at least 8 characters"),e.qZA()())}function J(n,r){1&n&&(e.TgZ(0,"div",21),e._UZ(1,"img",22),e.TgZ(2,"span"),e._uU(3,"Password should have at least one number"),e.qZA()())}function q(n,r){1&n&&(e.TgZ(0,"div",21),e._UZ(1,"img",22),e.TgZ(2,"span"),e._uU(3,"Password should have at least one special character"),e.qZA()())}function N(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"convoy-input-field")(2,"label",18),e._uU(3,"Create Password"),e.qZA(),e._UZ(4,"input",19),e.YNc(5,F,2,0,"convoy-input-error",0),e.qZA(),e.YNc(6,D,4,0,"div",20),e.YNc(7,J,4,0,"div",20),e.YNc(8,q,4,0,"div",20),e.BQk()),2&n){const t=e.oxw(3);let o;e.xp6(5),e.Q6J("ngIf",(null==(o=t.acceptInviteForm.get("password"))?null:o.touched)&&(null==(o=t.acceptInviteForm.get("password"))?null:o.invalid)),e.xp6(1),e.Q6J("ngIf",t.acceptInviteForm.controls.password.touched&&!t.checkForSpecialCharacter(t.acceptInviteForm.value.password)),e.xp6(1),e.Q6J("ngIf",t.acceptInviteForm.controls.password.touched&&!t.checkForNumber(t.acceptInviteForm.value.password)),e.xp6(1),e.Q6J("ngIf",t.acceptInviteForm.controls.password.touched&&!t.checkForSpecialCharacter(t.acceptInviteForm.value.password))}}function Q(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"Join your team"),e.qZA())}function P(n,r){1&n&&e._UZ(0,"img",23)}const Y=function(n){return{"mt-20px":n}};function k(n,r){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"img",3),e.TgZ(2,"h2",4),e._uU(3,"Join your team "),e.YNc(4,T,2,1,"span",0),e._uU(5," to start managing webhooks"),e.qZA(),e.YNc(6,b,2,1,"p",5),e.TgZ(7,"section",6)(8,"form",7),e.NdJ("ngSubmit",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.acceptInvite())}),e.TgZ(9,"div",8)(10,"convoy-input-field")(11,"label",9),e._uU(12,"First name"),e.qZA(),e._UZ(13,"input",10),e.YNc(14,C,2,0,"convoy-input-error",0),e.qZA(),e.TgZ(15,"convoy-input-field")(16,"label",11),e._uU(17,"Last name"),e.qZA(),e._UZ(18,"input",12),e.YNc(19,w,2,0,"convoy-input-error",0),e.qZA()(),e.TgZ(20,"convoy-input-field")(21,"label",13),e._uU(22,"Email Address"),e.qZA(),e._UZ(23,"input",14),e.YNc(24,U,2,0,"convoy-input-error",0),e.qZA(),e.YNc(25,N,9,4,"ng-container",0),e.TgZ(26,"button",15),e.YNc(27,Q,2,0,"span",0),e.YNc(28,P,1,0,"img",16),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw(2);let o,s,a;e.xp6(4),e.Q6J("ngIf",t.organisationName),e.xp6(2),e.Q6J("ngIf",!t.userDetailsAvailable),e.xp6(1),e.Q6J("ngClass",e.VKq(14,Y,t.userDetailsAvailable)),e.xp6(1),e.Q6J("formGroup",t.acceptInviteForm),e.xp6(5),e.Q6J("readonly",t.userDetailsAvailable),e.xp6(1),e.Q6J("ngIf",(null==(o=t.acceptInviteForm.get("first_name"))?null:o.touched)&&(null==(o=t.acceptInviteForm.get("first_name"))?null:o.invalid)),e.xp6(4),e.Q6J("readonly",t.userDetailsAvailable),e.xp6(1),e.Q6J("ngIf",(null==(s=t.acceptInviteForm.get("last_name"))?null:s.touched)&&(null==(s=t.acceptInviteForm.get("last_name"))?null:s.invalid)),e.xp6(4),e.Q6J("readonly",!0),e.xp6(1),e.Q6J("ngIf",(null==(a=t.acceptInviteForm.get("email"))?null:a.touched)&&(null==(a=t.acceptInviteForm.get("email"))?null:a.invalid)),e.xp6(1),e.Q6J("ngIf",!t.userDetailsAvailable),e.xp6(1),e.Q6J("disabled",t.loading),e.xp6(1),e.Q6J("ngIf",!t.loading),e.xp6(1),e.Q6J("ngIf",t.loading)}}function E(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"img",3)(2,"img",24),e.TgZ(3,"h2",4),e._uU(4,"This invitation has been accepted"),e.qZA(),e.TgZ(5,"p",17),e._uU(6,"Login to continue to your workspace"),e.qZA(),e.TgZ(7,"button",25),e._uU(8,"Go to Login"),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(7),e.Q6J("disabled",t.loading)}}function L(n,r){if(1&n&&(e.TgZ(0,"div",2),e.YNc(1,k,29,16,"ng-container",0),e.YNc(2,E,9,1,"ng-container",0),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.isInviteAccepted),e.xp6(1),e.Q6J("ngIf",t.isInviteAccepted)}}let S=(()=>{class n{constructor(t,o,s,a,u){this.formBuilder=t,this.acceptInviteService=o,this.route=s,this.router=a,this.generalService=u,this.showPassword=!1,this.showConfirmPassword=!1,this.loading=!1,this.fetchingDetails=!1,this.userDetailsAvailable=!1,this.isInviteAccepted=!1,this.acceptInviteForm=this.formBuilder.group({first_name:["",c.kI.required],last_name:["",c.kI.required],email:["",c.kI.required],role:this.formBuilder.group({type:["super_user"]}),password:["",c.kI.compose([c.kI.minLength(8),c.kI.required])]})}ngOnInit(){this.getUserDetails(this.route.snapshot.queryParams["invite-token"])}getUserDetails(t){var o=this;return(0,l.Z)(function*(){o.fetchingDetails=!0;try{const s=yield o.acceptInviteService.getUserDetails(t);o.userDetailsAvailable=!!s.data.user;const a=s.data.token;a?.organisation_name&&(o.organisationName=a?.organisation_name),o.isInviteAccepted="accepted"===a.status;const u=s.data.user;o.acceptInviteForm.patchValue({first_name:u?.first_name?u.first_name:"",last_name:u?.last_name?u.last_name:"",email:a.invitee_email,role:{type:a.role.type}}),o.fetchingDetails=!1}catch{o.fetchingDetails=!1}})()}acceptInvite(){var t=this;return(0,l.Z)(function*(){if(!t.userDetailsAvailable&&t.acceptInviteForm.invalid)return t.acceptInviteForm.markAllAsTouched();t.userDetailsAvailable&&delete t.acceptInviteForm.value.password,t.loading=!0;try{const o=t.route.snapshot.queryParams["invite-token"],s=yield t.acceptInviteService.acceptInvite({token:o,body:t.acceptInviteForm.value});t.loading=!1;const a=localStorage.getItem("CONVOY_AUTH");t.generalService.showNotification({style:"success",message:s.message}),t.router.navigateByUrl(t.userDetailsAvailable&&"undefined"!==a?"projects":"login")}catch(o){t.loading=!1,t.generalService.showNotification({style:"error",message:o.error.message})}})()}checkForNumber(t){return/\d/.test(t)}checkForSpecialCharacter(t){return/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/.test(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.qu),e.Y36(y),e.Y36(h.gz),e.Y36(h.F0),e.Y36(I.m))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-accept-invite"]],standalone:!0,features:[e.jDz],decls:2,vars:2,consts:[[4,"ngIf"],["class","bg-[url('/assets/img/Pattern.svg')] bg-center min-h-screen flex flex-col items-center justify-center bg-cover",4,"ngIf"],[1,"bg-[url('/assets/img/Pattern.svg')]","bg-center","min-h-screen","flex","flex-col","items-center","justify-center","bg-cover"],["src","/assets/img/logo.svg","alt","convoy logo",1,"mb-28px","w-130px"],[1,"font-semibold","text-20","mb-10px"],["class","text-grey-40 text-center text-16px max-w-[445px] mb-32px",4,"ngIf"],[1,"max-w-[445px]","mx-auto","px-24px","py-24px","w-full","bg-white-100","shadow-default","rounded-8px",3,"ngClass"],[3,"formGroup","ngSubmit"],[1,"grid","grid-cols-2","gap-6"],["for","first_name","convoy-label","","required","true"],["id","first_name","convoy-input","","autocomplete","first_name","formControlName","first_name","placeholder","Enter your first name",3,"readonly"],["for","last_name","convoy-label","","required","true"],["id","last_name","convoy-input","","autocomplete","last_name","formControlName","last_name","placeholder","Enter your last name",3,"readonly"],["for","email","convoy-label","","required","true"],["type","email","id","email","convoy-input","","autocomplete","email","formControlName","email","placeholder","Enter your email",3,"readonly"],["convoy-button","","size","lg",1,"mt-40px",3,"disabled"],["src","assets/img/button-loader.gif","alt","loader",4,"ngIf"],[1,"text-grey-40","text-center","text-16px","max-w-[445px]","mb-32px"],["for","new-password","convoy-label","","required","true"],["type","password","id","new-password","convoy-input","","autocomplete","new-password","formControlName","password","placeholder","Enter your password"],["class","flex items-center text-12 text-danger-100 mt-8px",4,"ngIf"],[1,"flex","items-center","text-12","text-danger-100","mt-8px"],["src","assets/img/input-error-icon.svg","alt","input error icon",1,"mr-8px","w-16px"],["src","assets/img/button-loader.gif","alt","loader"],["src","/assets/img/success.gif","alt","success",1,"mb-40px","h-100px","rounded-100px"],["convoy-button","","routerLink","/login",1,"w-[450px]","mb-20px",3,"disabled"]],template:function(t,o){1&t&&(e.YNc(0,Z,1,0,"convoy-loader",0),e.YNc(1,L,3,2,"div",1)),2&t&&(e.Q6J("ngIf",o.fetchingDetails),e.xp6(1),e.Q6J("ngIf",!o.fetchingDetails))},dependencies:[_.ez,_.mk,_.O5,c.UX,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,m.r,v.q,A.R,p.uZ,p.wo,p.Vd,p._n],styles:[".logo-2[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:150px;width:150px}"]}),n})()}}]);
//# sourceMappingURL=410.3b6f8da5b471445a.js.map