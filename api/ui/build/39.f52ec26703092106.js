"use strict";(self.webpackChunkconvoy_ng=self.webpackChunkconvoy_ng||[]).push([[39],{5454:(U,C,i)=>{i.d(C,{z:()=>_});var m=i(7073),e=i(4151),f=i(1354),A=i(385);let _=(()=>{class x{constructor(){this.closeModal=new e.vpe,this.deleteData=new e.vpe,this.isLoading=!1}ngOnInit(){}}return x.\u0275fac=function(n){return new(n||x)},x.\u0275cmp=e.Xpm({type:x,selectors:[["app-delete-modal"]],inputs:{isLoading:"isLoading",deleteText:"deleteText",deleteButtonText:"deleteButtonText"},outputs:{closeModal:"closeModal",deleteData:"deleteData"},standalone:!0,features:[e.jDz],decls:11,vars:3,consts:[["convoy-modal","","position","center","size","sm",3,"closeModal"],[1,"flex","flex-col","justify-center","items-center","px-20px","py-30px"],["src","/assets/img/warning.gif","alt","warning",1,"h-[126px]","w-[126px]"],[1,"text-16","font-semibold","text-black","mb-8px","text-center"],[1,"text-14","font-medium","text-grey-40","mb-20px"],["convoy-button","","color","danger",1,"mb-24px",3,"disabled","click"],["convoy-button","","fill","text",1,"font-semibold",3,"click"]],template:function(n,y){1&n&&(e.TgZ(0,"div",0),e.NdJ("closeModal",function(){return y.closeModal.emit()}),e.TgZ(1,"div",1),e._UZ(2,"img",2),e.TgZ(3,"p",3),e._uU(4),e.qZA(),e.TgZ(5,"p",4),e._uU(6,"This action is irrevesible."),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(){return y.deleteData.emit()}),e._uU(8),e.qZA(),e.TgZ(9,"button",6),e.NdJ("click",function(){return y.closeModal.emit()}),e._uU(10,"No, Cancel"),e.qZA()()()),2&n&&(e.xp6(4),e.hij("Are you sure you want to ",y.deleteText,"?"),e.xp6(3),e.Q6J("disabled",y.isLoading),e.xp6(1),e.Oqu(y.deleteButtonText?"Yes, "+y.deleteButtonText:"Yes, Delete"))},dependencies:[m.ez,A.zS,f.r]}),x})()},3273:(U,C,i)=>{i.d(C,{I:()=>j});var m=i(9369),e=i(4151),f=i(7073),A=i(3117),_=i(385),x=i(1354),h=i(545),n=i(6907),y=i(2065),K=i(455),b=i(3579),Z=i(2187),M=i(5456),I=i(5454),F=i(372),w=i(7205),N=i(4330),E=i(6440),c=i(3755);let u=(()=>{class o{constructor(t){this.http=t}generateKey(t){var s=this;return new Promise(function(){var a=(0,m.Z)(function*(l,g){try{return l(yield s.http.request({url:`/endpoints/${t.endpointId}/keys`,method:"post",body:t.body,level:"org_project"}))}catch(v){return g(v)}});return function(l,g){return a.apply(this,arguments)}}())}getApiKeys(t){var s=this;return new Promise(function(){var a=(0,m.Z)(function*(l,g){try{return l(yield s.http.request({url:t.token?"/keys":`/endpoints/${t.endpointId}/keys`,method:"get",level:"org_project"}))}catch(v){return g(v)}});return function(l,g){return a.apply(this,arguments)}}())}revokeApiKey(t){var s=this;return new Promise(function(){var a=(0,m.Z)(function*(l,g){try{return l(yield s.http.request({url:`/endpoints/${t.endpointId}/keys/${t.keyId}/revoke`,method:"put",body:null,level:"org_project"}))}catch(v){return g(v)}});return function(l,g){return a.apply(this,arguments)}}())}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(c.O))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var r=i(493);function p(o,d){1&o&&(e.ynx(0),e._UZ(1,"div",5),e.BQk())}function J(o,d){1&o&&(e.TgZ(0,"div",7)(1,"div")(2,"div",8),e._UZ(3,"convoy-skeleton-loader",9)(4,"convoy-skeleton-loader",10),e.qZA(),e._UZ(5,"convoy-skeleton-loader",11),e.qZA(),e._UZ(6,"convoy-skeleton-loader",11),e.qZA())}function O(o,d){if(1&o&&(e.ynx(0),e.YNc(1,J,7,0,"div",6),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.loaderIndex)}}function k(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return l.selectedApiKey=a,e.KtG(l.showRevokeApiModal=!0)}),e._uU(1,"Revoke"),e.qZA()}}function D(o,d){if(1&o&&(e.TgZ(0,"div",13)(1,"div")(2,"div",8)(3,"p",14),e._uU(4),e.qZA(),e.TgZ(5,"convoy-tag",15),e._uU(6),e.qZA(),e.TgZ(7,"convoy-tag",16),e.ALo(8,"statuscolor"),e._uU(9),e.qZA()(),e.TgZ(10,"p",17),e._uU(11),e.ALo(12,"date"),e.qZA()(),e.YNc(13,k,2,0,"button",18),e.qZA()),2&o){const t=d.$implicit,s=e.oxw(2);e.xp6(4),e.Oqu(t.name),e.xp6(2),e.Oqu(t.role.type),e.xp6(1),e.Q6J("type",e.lcZ(8,6,s.getKeyStatus(t.expires_at))),e.xp6(2),e.Oqu(s.getKeyStatus(t.expires_at)),e.xp6(2),e.hij("Expires At: ",e.xi3(12,8,t.expires_at,"medium"),""),e.xp6(2),e.Q6J("ngIf","active"===s.getKeyStatus(t.expires_at))}}function T(o,d){if(1&o&&(e.ynx(0),e.YNc(1,D,14,11,"div",12),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.apiKeys)}}function Q(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"convoy-token-modal",20),e.NdJ("closeModal",function(){e.CHM(t);const a=e.oxw();return a.showApiKey=!1,e.KtG(a.getApiKeys())}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("token",t.apiKey)}}function S(o,d){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"convoy-select",32),e.NdJ("selectedOption",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.setEndpointId(a))}),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("options",t.endpoints)("value",t.endpointId)("required",!0)}}const Y=function(o){return{"mt-24px":o}};function G(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",21),e.NdJ("closeModal",function(){e.CHM(t);const a=e.oxw();return a.generateKeyModal=!1,e.KtG(a.generateKeyForm.reset())}),e.TgZ(1,"div",22)(2,"h2",23),e._uU(3,"Generate CLI key"),e.qZA(),e.TgZ(4,"button",24),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return a.generateKeyModal=!1,e.KtG(a.generateKeyForm.reset())}),e._UZ(5,"img",25),e.qZA()(),e.TgZ(6,"form",26),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.generateNewKey())}),e.YNc(7,S,2,3,"ng-container",1),e.TgZ(8,"convoy-input-field")(9,"label",27),e._uU(10,"CLI key name"),e.qZA(),e._UZ(11,"input",28),e.qZA(),e.TgZ(12,"convoy-select",29),e.NdJ("selectedOption",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.generateKeyForm.patchValue({expiration:a}))}),e.qZA(),e.TgZ(13,"div",30)(14,"button",31),e._uU(15,"Generate Key"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.generateKeyForm),e.xp6(1),e.Q6J("ngIf",t.token),e.xp6(2),e.Q6J("ngClass",e.VKq(4,Y,t.token)),e.xp6(3),e.Q6J("options",t.expirationDates)}}function L(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"app-delete-modal",33),e.NdJ("closeModal",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.showRevokeApiModal=!1)})("deleteData",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.revokeApiKey())}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("isLoading",t.isRevokingApiKey)("deleteText","revoke \u201c"+(null==t.selectedApiKey?null:t.selectedApiKey.name)+" cli key\u201d")}}let j=(()=>{class o{constructor(t,s,a,l,g){this.route=t,this.generalService=s,this.privateService=a,this.formBuilder=l,this.cliKeyService=g,this.cliError=new e.vpe,this.isFetchingApiKeys=!1,this.showApiKey=!1,this.showRevokeApiModal=!1,this.isRevokingApiKey=!1,this.generateKeyModal=!1,this.isGeneratingNewKey=!1,this.isloadingAppPortalAppDetails=!1,this.showError=!1,this.loaderIndex=[0,1,2],this.endpointId=this.route.snapshot.params.id,this.token=this.route.snapshot.queryParams.token,this.expirationDates=[{name:"7 days",uid:7},{name:"14 days",uid:14},{name:"30 days",uid:30},{name:"90 days",uid:90}],this.generateKeyForm=this.formBuilder.group({name:[""],expiration:[""],key_type:["cli"],endpoint_id:[]})}ngOnInit(){var t=this;return(0,m.Z)(function*(){yield Promise.all([t.getApiKeys(),t.getEndpoints()])})()}getApiKeys(){var t=this;return(0,m.Z)(function*(){t.cliError.emit(!1),t.showError=!1,t.isFetchingApiKeys=!0;try{const s=yield t.cliKeyService.getApiKeys({endpointId:t.endpointId,token:t.token});t.apiKeys=s.data.content,t.isFetchingApiKeys=!1}catch{return t.cliError.emit(!0),t.showError=!0,void(t.isFetchingApiKeys=!1)}})()}generateNewKey(){var t=this;return(0,m.Z)(function*(){t.isGeneratingNewKey=!0,t.generateKeyForm.value.expiration=parseInt(t.generateKeyForm.value.expiration);try{const s=yield t.cliKeyService.generateKey({endpointId:t.endpointId,body:t.generateKeyForm.value});t.apiKey=s.data.key,t.generateKeyModal=!1,t.showApiKey=!0,t.generateKeyForm.reset(),t.generateKeyForm.patchValue({key_type:"cli"}),t.generalService.showNotification({message:s.message,style:"success"}),t.isGeneratingNewKey=!1}catch{return void(t.isGeneratingNewKey=!1)}})()}revokeApiKey(){var t=this;return(0,m.Z)(function*(){if(t.selectedApiKey){t.isRevokingApiKey=!0;try{const s=yield t.cliKeyService.revokeApiKey({endpointId:t.selectedApiKey?.role.endpoint,keyId:t.selectedApiKey?.uid});t.generalService.showNotification({message:s.message,style:"success"}),t.isRevokingApiKey=!1,t.showRevokeApiModal=!1,t.getApiKeys()}catch{t.isRevokingApiKey=!1}}})()}getEndpoints(){var t=this;return(0,m.Z)(function*(){if(t.token)try{const a=(yield t.privateService.getEndpoints()).data;a.forEach(l=>{l.name=l.title}),t.endpoints=a}catch{return}})()}setEndpointId(t){this.endpointId=t,this.generateKeyForm.patchValue({endpoint_id:t})}getKeyStatus(t){return new Date>new Date(t)?"disabled":"active"}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(w.gz),e.Y36(N.m),e.Y36(E.i),e.Y36(n.qu),e.Y36(u))},o.\u0275cmp=e.Xpm({type:o,selectors:[["convoy-cli-keys"]],outputs:{cliError:"cliError"},standalone:!0,features:[e.jDz],decls:7,vars:6,consts:[["convoy-card","",1,"mb-20px","min-h-[30vh]","rounded-tl-[0]","rounded-tr-[0]"],[4,"ngIf"],["title","Cli Key Generated Successfully","description","Your Cli Key has been created. Please copy this key and save it somewhere safe.",3,"token","closeModal",4,"ngIf"],["convoy-modal","",3,"closeModal",4,"ngIf"],["deleteButtonText","revoke",3,"isLoading","deleteText","closeModal","deleteData",4,"ngIf"],["convoy-empty-state","","imgSrc","/assets/img/events-log-empty-state.png","heading","You do not have any keys","id","empty-state",1,"py-54px"],["class","flex justify-between items-center p-22px",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","p-22px"],[1,"flex","items-center","mb-8px"],["className","h-20px w-100px"],["className","h-14px w-60px ml-10px"],["className","h-14px w-120px"],["class","flex justify-between items-center pb-10px px-22px mt-24px bg-[#fcfcfc] border-b border-b-grey-10 last-of-type:border-none",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","pb-10px","px-22px","mt-24px","bg-[#fcfcfc]","border-b","border-b-grey-10","last-of-type:border-none"],[1,"text-12","font-medium","mr-36px"],["type","grey","className","mr-16px"],[3,"type"],[1,"text-grey-40","text-12","mt-8px"],["convoy-button","","size","xs","fill","text","color","danger","class","font-medium",3,"click",4,"ngIf"],["convoy-button","","size","xs","fill","text","color","danger",1,"font-medium",3,"click"],["title","Cli Key Generated Successfully","description","Your Cli Key has been created. Please copy this key and save it somewhere safe.",3,"token","closeModal"],["convoy-modal","",3,"closeModal"],["convoy-modal-header",""],[1,"font-semibold","capitalize"],["convoy-button","","texture","light","size","sm",1,"px-8px","!py-10px",3,"click"],["src","/assets/img/modal-close-icon.svg","alt","close icon"],[1,"p-20px",3,"formGroup","ngSubmit"],["for","name","convoy-label","",3,"ngClass"],["id","name","convoy-input","","autocomplete","name","formControlName","name","placeholder","CLI key name"],["label","Expiration","name","expiration","formControlName","expiration",3,"options","selectedOption"],[1,"flex","justify-end","mt-24px"],["convoy-button",""],["label","Endpoint","name","endpoint_id","formControlName","endpoint_id","errorMessage","Endpoint Id is required",3,"options","value","required","selectedOption"],["deleteButtonText","revoke",3,"isLoading","deleteText","closeModal","deleteData"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.YNc(1,p,2,0,"ng-container",1),e.YNc(2,O,2,1,"ng-container",1),e.YNc(3,T,2,1,"ng-container",1),e.qZA(),e.YNc(4,Q,1,1,"convoy-token-modal",2),e.YNc(5,G,16,6,"div",3),e.YNc(6,L,1,2,"app-delete-modal",4)),2&t&&(e.xp6(1),e.Q6J("ngIf",s.showError||!s.isFetchingApiKeys&&0===(null==s.apiKeys?null:s.apiKeys.length)),e.xp6(1),e.Q6J("ngIf",s.isFetchingApiKeys),e.xp6(1),e.Q6J("ngIf",!s.isFetchingApiKeys&&s.apiKeys),e.xp6(1),e.Q6J("ngIf",s.showApiKey),e.xp6(1),e.Q6J("ngIf",s.generateKeyModal),e.xp6(1),e.Q6J("ngIf",s.showRevokeApiModal))},dependencies:[f.ez,f.mk,f.sg,f.O5,f.uU,n.UX,n._Y,n.Fj,n.JJ,n.JL,n.Q7,n.sg,n.u,A.A,_.zS,_.Rb,x.r,h.t,y.s,K.Z,b.K,r.k,M.H,I.z,Z.uZ,Z.Vd,Z._n,F.J]}),o})()},8763:(U,C,i)=>{i.d(C,{Z:()=>E});var m=i(9369),e=i(7073),f=i(3117),A=i(545),_=i(455),x=i(2065),h=i(3579),n=i(4151),y=i(7205),K=i(3755);let b=(()=>{class c{constructor(r){this.http=r}getAppDevices(r,p){var J=this;return new Promise(function(){var O=(0,m.Z)(function*(k,D){try{return k(yield J.http.request({url:p?`/devices?token=${p}`:`/endpoints/${r}/devices`,method:"get",level:"org_project"}))}catch(T){return D(T)}});return function(k,D){return O.apply(this,arguments)}}())}}return c.\u0275fac=function(r){return new(r||c)(n.LFG(K.O))},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})();var Z=i(493);function M(c,u){1&c&&(n.ynx(0),n._UZ(1,"div",2),n.BQk())}function I(c,u){1&c&&(n.TgZ(0,"div",4)(1,"div")(2,"div",5),n._UZ(3,"convoy-skeleton-loader",6)(4,"convoy-skeleton-loader",7),n.qZA(),n._UZ(5,"convoy-skeleton-loader",8),n.qZA(),n._UZ(6,"convoy-skeleton-loader",8),n.qZA())}function F(c,u){if(1&c&&(n.ynx(0),n.YNc(1,I,7,0,"div",3),n.BQk()),2&c){const r=n.oxw();n.xp6(1),n.Q6J("ngForOf",r.loaderIndex)}}function w(c,u){if(1&c&&(n.TgZ(0,"div",10)(1,"div")(2,"div",11)(3,"p",12),n._uU(4),n.qZA(),n.TgZ(5,"convoy-tag",13),n.ALo(6,"statuscolor"),n._uU(7),n.qZA()()(),n.TgZ(8,"div")(9,"p",14),n._uU(10),n.ALo(11,"date"),n.qZA()()()),2&c){const r=u.$implicit;n.xp6(4),n.Oqu(r.host_name),n.xp6(1),n.Q6J("type",n.lcZ(6,4,r.status)),n.xp6(2),n.Oqu(r.status),n.xp6(3),n.hij("Last Seen: ",n.xi3(11,6,r.last_seen_at,"medium"),"")}}function N(c,u){if(1&c&&(n.ynx(0),n.YNc(1,w,12,9,"div",9),n.BQk()),2&c){const r=n.oxw();n.xp6(1),n.Q6J("ngForOf",r.devices)}}let E=(()=>{class c{constructor(r,p){this.route=r,this.deviceService=p,this.endpointId=this.route.snapshot.params.id,this.isFetchingDevices=!1,this.isloadingAppPortalAppDetails=!1,this.showError=!1,this.loaderIndex=[0,1,2],this.token=this.route.snapshot.queryParams.token}ngOnInit(){this.getDevices()}getDevices(){var r=this;return(0,m.Z)(function*(){r.showError=!1,r.isFetchingDevices=!0;try{const p=yield r.deviceService.getAppDevices(r.endpointId,r.token);r.devices=p.data.content,r.isFetchingDevices=!1}catch{return r.showError=!0,void(r.isFetchingDevices=!1)}})()}}return c.\u0275fac=function(r){return new(r||c)(n.Y36(y.gz),n.Y36(b))},c.\u0275cmp=n.Xpm({type:c,selectors:[["convoy-devices"]],standalone:!0,features:[n.jDz],decls:4,vars:3,consts:[["convoy-card","",1,"mb-20px","min-h-[30vh]","rounded-tl-[0]","rounded-tr-[0]"],[4,"ngIf"],["convoy-empty-state","","imgSrc","/assets/img/events-log-empty-state.png","heading","You have no devices","id","empty-state",1,"py-54px"],["class","flex justify-between items-center p-22px",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","p-22px"],[1,"flex","items-center","mb-8px"],["className","h-20px w-100px"],["className","h-14px w-60px ml-10px"],["className","h-14px w-120px"],["class","flex justify-between items-center pb-10px px-22px mt-24px bg-[#fcfcfc] border-b border-b-grey-10 last-of-type:border-none",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","pb-10px","px-22px","mt-24px","bg-[#fcfcfc]","border-b","border-b-grey-10","last-of-type:border-none"],[1,"flex","items-center"],[1,"text-12","font-medium","mr-36px"],[3,"type"],[1,"text-grey-40","text-12","mt-8px"]],template:function(r,p){1&r&&(n.TgZ(0,"div",0),n.YNc(1,M,2,0,"ng-container",1),n.YNc(2,F,2,1,"ng-container",1),n.YNc(3,N,2,1,"ng-container",1),n.qZA()),2&r&&(n.xp6(1),n.Q6J("ngIf",p.showError||!p.isFetchingDevices&&0===(null==p.devices?null:p.devices.length)),n.xp6(1),n.Q6J("ngIf",p.isFetchingDevices),n.xp6(1),n.Q6J("ngIf",!p.isFetchingDevices&&p.devices))},dependencies:[e.ez,e.sg,e.O5,e.uU,f.A,A.t,_.Z,x.s,h.K,Z.k]}),c})()}}]);
//# sourceMappingURL=39.f52ec26703092106.js.map