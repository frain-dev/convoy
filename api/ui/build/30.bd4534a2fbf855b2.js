"use strict";(self.webpackChunkconvoy_ng=self.webpackChunkconvoy_ng||[]).push([[30],{7030:(Z,E,r)=>{r.d(E,{G:()=>D});var _=r(9369),n=r(4151),y=r(7073),u=r(6907),m=r(2187),x=r(1354),s=r(7933),g=r(3270),f=r(3117),c=r(2224),d=r(4330),a=r(3755);let b=(()=>{class e{constructor(t){this.http=t}addNewEndpoint(t){var o=this;return new Promise(function(){var i=(0,_.Z)(function*(p,v){try{return p(yield o.http.request({url:"/endpoints",body:t.body,method:"post",level:"org_project"}))}catch(h){return v(h)}});return function(p,v){return i.apply(this,arguments)}}())}editEndpoint(t){var o=this;return new Promise(function(){var i=(0,_.Z)(function*(p,v){try{return p(yield o.http.request({url:`/endpoints/${t.endpointId}`,body:t.body,method:"put",level:"org_project"}))}catch(h){return v(h)}});return function(p,v){return i.apply(this,arguments)}}())}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(a.O))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var C=r(7205),w=r(6440),A=r(5409);function T(e,l){1&e&&(n.TgZ(0,"convoy-input-error"),n._uU(1,"Please provide a name"),n.qZA())}function U(e,l){1&e&&(n.TgZ(0,"convoy-input-error"),n._uU(1,"Endpoint URL is required"),n.qZA())}function N(e,l){if(1&e){const t=n.EpF();n.ynx(0),n.TgZ(1,"div",16)(2,"p",17),n._uU(3,"Alert Configuration"),n.qZA(),n.TgZ(4,"button",18),n.NdJ("click",function(){n.CHM(t);const i=n.oxw();return n.KtG(i.toggleConfigForm("alert-config"))}),n.O4$(),n.TgZ(5,"svg",19),n._UZ(6,"use",20),n.qZA()()(),n.kcU(),n.TgZ(7,"div",21)(8,"convoy-input-field")(9,"label",22),n._uU(10,"Support Email"),n.qZA(),n._UZ(11,"input",23),n.qZA(),n.TgZ(12,"convoy-input-field")(13,"label",24),n._uU(14,"Slack webhook url"),n.qZA(),n._UZ(15,"input",25),n.qZA()(),n.BQk()}}function k(e,l){if(1&e){const t=n.EpF();n.ynx(0),n.TgZ(1,"div",16)(2,"p",26),n._uU(3," Endpoint Authentication "),n.TgZ(4,"convoy-tooltip",27),n._uU(5,"You can set your provided endpoint authentication is any is required"),n.qZA()(),n.TgZ(6,"button",18),n.NdJ("click",function(){n.CHM(t);const i=n.oxw();return n.KtG(i.toggleConfigForm("auth"))}),n.O4$(),n.TgZ(7,"svg",19),n._UZ(8,"use",20),n.qZA()()(),n.kcU(),n.ynx(9,28),n.TgZ(10,"div",29)(11,"convoy-input-field")(12,"label",30),n._uU(13,"API Key Name"),n.qZA(),n._UZ(14,"input",31),n.qZA(),n.TgZ(15,"convoy-input-field")(16,"label",32),n._uU(17,"API Key Value"),n.qZA(),n._UZ(18,"input",33),n.qZA()(),n.BQk()()}}function F(e,l){if(1&e){const t=n.EpF();n.ynx(0),n.TgZ(1,"div",16)(2,"p",17),n._uU(3," Signature Details "),n.TgZ(4,"convoy-tooltip",27),n._uU(5,"This specifies your signature format for your project."),n.qZA()(),n.TgZ(6,"button",18),n.NdJ("click",function(){n.CHM(t);const i=n.oxw();return n.KtG(i.toggleConfigForm("signature"))}),n.O4$(),n.TgZ(7,"svg",19),n._UZ(8,"use",20),n.qZA()()(),n.kcU(),n.TgZ(9,"div",34),n._UZ(10,"convoy-radio",35)(11,"convoy-radio",36),n.qZA(),n.BQk()}2&e&&(n.xp6(10),n.Q6J("value",!1),n.xp6(1),n.Q6J("value",!0))}function I(e,l){if(1&e){const t=n.EpF();n.TgZ(0,"button",38),n.NdJ("click",function(){n.CHM(t);const i=n.oxw(2).$implicit,p=n.oxw();return n.KtG(p.toggleConfigForm(i.uid))}),n._uU(1),n._UZ(2,"img",39),n.qZA()}if(2&e){const t=n.oxw(2).$implicit;n.xp6(1),n.hij(" ",t.name," ")}}function J(e,l){if(1&e&&(n.ynx(0),n.YNc(1,I,3,1,"button",37),n.BQk()),2&e){const t=n.oxw().index,o=n.oxw();n.xp6(1),n.Q6J("ngIf",t<2||"outgoing"===(null==o.privateService.activeProjectDetails?null:o.privateService.activeProjectDetails.type))}}function q(e,l){if(1&e&&(n.ynx(0),n.YNc(1,J,2,1,"ng-container",4),n.BQk()),2&e){const t=l.$implicit;n.xp6(1),n.Q6J("ngIf",!t.show)}}function S(e,l){if(1&e&&n._UZ(0,"div",40),2&e){const t=n.oxw();n.Q6J("loading",!t.endpointCreated)}}function Q(e,l){if(1&e){const t=n.EpF();n.TgZ(0,"button",41),n.NdJ("click",function(){n.CHM(t);const i=n.oxw();return n.KtG(i.saveEndpoint())}),n._uU(1),n.qZA()}if(2&e){const t=n.oxw();n.Q6J("disabled",t.savingEndpoint),n.xp6(1),n.hij(" ",t.savingEndpoint?"Creating Endpoint..":"Create Endpoint"," ")}}function Y(e,l){if(1&e){const t=n.EpF();n.TgZ(0,"button",41),n.NdJ("click",function(){n.CHM(t);const i=n.oxw();return n.KtG(i.saveEndpoint())}),n._uU(1),n.qZA()}if(2&e){const t=n.oxw();n.Q6J("disabled",t.savingEndpoint),n.xp6(1),n.hij(" ",t.savingEndpoint?"Updating Endpoint..":"Update Endpoint"," ")}}const M=function(e){return{hidden:e}},j=["*"];let D=(()=>{class e{constructor(t,o,i,p,v,h,L){this.formBuilder=t,this.generalService=o,this.createEndpointService=i,this.route=p,this.privateService=v,this.router=h,this.endpointService=L,this.editMode=!1,this.showAction="false",this.onAction=new n.vpe,this.savingEndpoint=!1,this.isLoadingEndpointDetails=!1,this.isLoadingEndpoints=!1,this.addNewEndpointForm=this.formBuilder.group({name:["",u.kI.required],support_email:[],slack_webhook_url:[],url:["",u.kI.required],secret:[null],http_timeout:[null],description:[null],authentication:this.formBuilder.group({type:["api_key"],api_key:this.formBuilder.group({header_name:[""],header_value:[""]})}),advanced_signatures:[!1,u.kI.required]}),this.token=this.route.snapshot.params.token,this.endpointUid=this.route.snapshot.params.id,this.enableMoreConfig=!1,this.configurations=[{uid:"alert-config",name:"Alert Configuration",show:!1},{uid:"auth",name:"Authentication",show:!1},{uid:"signature",name:"Signature Format",show:!1}],this.endpointCreated=!1}ngOnInit(){this.endpointUid&&this.editMode&&this.getEndpointDetails()}saveEndpoint(){var t=this;return(0,_.Z)(function*(){if(t.addNewEndpointForm.invalid)return t.addNewEndpointForm.markAllAsTouched();t.savingEndpoint=!0,!t.addNewEndpointForm.value.authentication.api_key.header_name&&!t.addNewEndpointForm.value.authentication.api_key.header_value&&delete t.addNewEndpointForm.value.authentication;try{const o=t.endpointUid&&t.editMode?yield t.createEndpointService.editEndpoint({endpointId:t.endpointUid||"",body:t.addNewEndpointForm.value}):yield t.createEndpointService.addNewEndpoint({body:t.addNewEndpointForm.value});return t.generalService.showNotification({message:o.message,style:"success"}),t.onAction.emit({action:t.endpointUid&&t.editMode?"update":"save",data:o.data}),t.addNewEndpointForm.reset(),t.endpointCreated=!0,o}catch{return t.endpointCreated=!1,void(t.savingEndpoint=!1)}})()}getEndpointDetails(){var t=this;return(0,_.Z)(function*(){t.isLoadingEndpointDetails=!0;try{const i=(yield t.endpointService.getEndpoint(t.endpointUid)).data;t.addNewEndpointForm.patchValue(i),t.addNewEndpointForm.patchValue({name:i.title,url:i.target_url}),i.support_email&&t.toggleConfigForm("alert-config"),i.authentication&&t.toggleConfigForm("auth"),t.isLoadingEndpointDetails=!1}catch{t.isLoadingEndpointDetails=!1}})()}getEndpoints(){var t=this;return(0,_.Z)(function*(){t.isLoadingEndpoints=!0;try{(yield t.privateService.getEndpoints()).data.content.length>0&&t.router.url.includes("/configure")&&t.onAction.emit({action:"save"}),t.isLoadingEndpoints=!1}catch{t.isLoadingEndpoints=!1}})()}toggleConfigForm(t){this.configurations.forEach(o=>{o.uid===t&&(o.show=!o.show)})}showConfig(t){return this.configurations.find(o=>o.uid===t)?.show||!1}cancel(){this.onAction.emit({action:"close"})}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(u.qu),n.Y36(d.m),n.Y36(b),n.Y36(C.gz),n.Y36(w.i),n.Y36(C.F0),n.Y36(A.n))},e.\u0275cmp=n.Xpm({type:e,selectors:[["convoy-create-endpoint"]],inputs:{editMode:"editMode",showAction:"showAction"},outputs:{onAction:"onAction"},standalone:!0,features:[n.jDz],ngContentSelectors:j,decls:29,vars:15,consts:[["convoy-card","",1,"p-24px","relative"],[3,"formGroup"],["for","name","convoy-label","","required","true"],["id","name","convoy-input","","autocomplete","name","formControlName","name","placeholder","e.g paystack-prod"],[4,"ngIf"],["for","url","convoy-label","","required","true"],["type","url","id","url","convoy-input","","autocomplete","url","formControlName","url","placeholder","Enter URL"],[1,"border-grey-10","mb-24px"],[1,"text-16","font-semibold","mb-16px"],[1,"flex","items-center"],[4,"ngFor","ngForOf"],[1,"empty:hidden"],["convoy-form-loader","",3,"loading",4,"ngIf"],[1,"flex","justify-end","mt-40px","mb-60px",3,"ngClass"],["convoy-button","","fill","outline",1,"mr-24px",3,"click"],["convoy-button","",3,"disabled","click",4,"ngIf"],[1,"flex","justify-between","items-center","mb-16px"],[1,"text-14","font-medium","text-grey-60","flex","items-center"],["convoy-button","","type","button","size","xs","fill","outline","color","grey","texture","light",3,"click"],["width","16","height","16",1,"fill-grey-60"],[0,"xlink","href","#delete-icon"],[1,"grid","grid-cols-2","gap-24px"],["for","support-email","convoy-label","","tooltip","We use this to send an email notifcation for when a failure happens"],["id","support-email","convoy-input","","autocomplete","suport-email","formControlName","support_email","placeholder","Enter support email"],["for","slack-url","convoy-label","","tooltip","We use this to send notifications to your slack channel when a failure happens"],["id","slack-url","convoy-input","","autocomplete","slack-url","formControlName","slack_webhook_url","placeholder","Enter slack webhook URL"],[1,"flex","items-center","text-14","font-medium","text-grey-60"],["size","sm","position","right",1,"ml-4px"],["formGroupName","authentication"],["formGroupName","api_key",1,"grid","grid-cols-2","gap-24px"],["for","header_name","convoy-label",""],["id","header_name","convoy-input","","autocomplete","header_name","formControlName","header_name","placeholder","Name"],["for","header_value","convoy-label",""],["id","header_value","convoy-input","","autocomplete","header_value","formControlName","header_value","placeholder","Value"],[1,"grid","grid-cols-2","gap-6","mb-50px"],["formControlName","advanced_signatures","label","Simple","_name","signature","_id","simple",3,"value"],["formControlName","advanced_signatures","label","Advanced","_name","signature","_id","advanced",3,"value"],["convoy-button","","size","sm","fill","outline","color","grey","texture","light","type","button","class","mr-24px font-normal",3,"click",4,"ngIf"],["convoy-button","","size","sm","fill","outline","color","grey","texture","light","type","button",1,"mr-24px","font-normal",3,"click"],["src","assets/img/svg/plus-icon.svg","alt","plus icon",1,"ml-24px"],["convoy-form-loader","",3,"loading"],["convoy-button","",3,"disabled","click"]],template:function(t,o){if(1&t&&(n.F$t(),n.TgZ(0,"div")(1,"div",0)(2,"form",1)(3,"convoy-input-field")(4,"label",2),n._uU(5,"Endpoint Name"),n.qZA(),n._UZ(6,"input",3),n.YNc(7,T,2,0,"convoy-input-error",4),n.qZA(),n.TgZ(8,"convoy-input-field")(9,"label",5),n._uU(10,"Enter URL"),n.qZA(),n._UZ(11,"input",6),n.YNc(12,U,2,0,"convoy-input-error",4),n.qZA(),n._UZ(13,"hr",7),n.TgZ(14,"h2",8),n._uU(15,"Set Configurations"),n.qZA(),n.YNc(16,N,16,0,"ng-container",4),n.YNc(17,k,19,0,"ng-container",4),n.YNc(18,F,12,2,"ng-container",4),n.TgZ(19,"div",9),n.YNc(20,q,2,1,"ng-container",10),n.qZA()(),n.TgZ(21,"div",11),n.Hsn(22),n.qZA(),n.YNc(23,S,1,1,"div",12),n.qZA(),n.TgZ(24,"div",13)(25,"button",14),n.NdJ("click",function(){return o.cancel()}),n._uU(26,"Discard"),n.qZA(),n.YNc(27,Q,2,2,"button",15),n.YNc(28,Y,2,2,"button",15),n.qZA()()),2&t){let i,p;n.Tol("true"===o.showAction?"pt-40px":"pt-20px"),n.xp6(2),n.Q6J("formGroup",o.addNewEndpointForm),n.xp6(5),n.Q6J("ngIf",(null==(i=o.addNewEndpointForm.get("name"))?null:i.touched)&&(null==(i=o.addNewEndpointForm.get("name"))?null:i.invalid)),n.xp6(5),n.Q6J("ngIf",(null==(p=o.addNewEndpointForm.get("url"))?null:p.touched)&&(null==(p=o.addNewEndpointForm.get("url"))?null:p.invalid)),n.xp6(4),n.Q6J("ngIf",o.showConfig("alert-config")),n.xp6(1),n.Q6J("ngIf",o.showConfig("auth")),n.xp6(1),n.Q6J("ngIf",o.showConfig("signature")),n.xp6(2),n.Q6J("ngForOf",o.configurations),n.xp6(3),n.Q6J("ngIf",o.savingEndpoint),n.xp6(1),n.Q6J("ngClass",n.VKq(13,M,"false"===o.showAction)),n.xp6(3),n.Q6J("ngIf",!o.editMode),n.xp6(1),n.Q6J("ngIf",o.editMode)}},dependencies:[y.ez,y.mk,y.sg,y.O5,u.UX,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,u.x0,m.Vd,m.wo,m.uZ,m._n,x.r,s.U,g.K,f.A,c.S]}),e})()},5409:(Z,E,r)=>{r.d(E,{n:()=>u});var _=r(9369),n=r(4151),y=r(3755);let u=(()=>{class m{constructor(s){this.http=s}getEndpoint(s){var g=this;return new Promise(function(){var f=(0,_.Z)(function*(c,d){try{return c(yield g.http.request({url:`/endpoints/${s}`,method:"get",level:"org_project"}))}catch(a){return d(a)}});return function(c,d){return f.apply(this,arguments)}}())}deleteEndpoint(s){var g=this;return new Promise(function(){var f=(0,_.Z)(function*(c,d){try{return c(yield g.http.request({url:`/endpoints/${s}`,method:"delete",level:"org_project"}))}catch(a){return d(a)}});return function(c,d){return f.apply(this,arguments)}}())}expireSecret(s){var g=this;return new Promise(function(){var f=(0,_.Z)(function*(c,d){try{return c(yield g.http.request({url:`/endpoints/${s.endpointId}/expire_secret`,method:"put",body:s.body,level:"org_project"}))}catch(a){return d(a)}});return function(c,d){return f.apply(this,arguments)}}())}sendEvent(s){var g=this;return new Promise(function(){var f=(0,_.Z)(function*(c,d){try{return c(yield g.http.request({url:"/events",body:s.body,method:"post",level:"org_project"}))}catch(a){return d(a)}});return function(c,d){return f.apply(this,arguments)}}())}toggleEndpoint(s){var g=this;return new Promise(function(){var f=(0,_.Z)(function*(c,d){try{return c(yield g.http.request({url:`/endpoints/${s}/pause`,method:"put",level:"org_project"}))}catch(a){return d(a)}});return function(c,d){return f.apply(this,arguments)}}())}}return m.\u0275fac=function(s){return new(s||m)(n.LFG(y.O))},m.\u0275prov=n.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);
//# sourceMappingURL=30.bd4534a2fbf855b2.js.map