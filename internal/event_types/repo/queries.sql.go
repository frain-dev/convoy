// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: queries.sql

package repo

import (
	"context"

	"github.com/jackc/pgx/v5/pgconn"
	"github.com/jackc/pgx/v5/pgtype"
)

const checkEventTypeExists = `-- name: CheckEventTypeExists :one

SELECT EXISTS(
    SELECT 1
    FROM convoy.event_types
    WHERE name = $1 AND project_id = $2
) AS exists
`

type CheckEventTypeExistsParams struct {
	Name      string
	ProjectID string
}

// ============================================================================
// CHECK Operations
// ============================================================================
func (q *Queries) CheckEventTypeExists(ctx context.Context, arg CheckEventTypeExistsParams) (bool, error) {
	row := q.db.QueryRow(ctx, checkEventTypeExists, arg.Name, arg.ProjectID)
	var exists bool
	err := row.Scan(&exists)
	return exists, err
}

const createDefaultEventType = `-- name: CreateDefaultEventType :exec
INSERT INTO convoy.event_types (
    id, name, description, category, project_id, json_schema, created_at, updated_at
) VALUES (
    $1, $2, $3, $4, $5, $6, NOW(), NOW()
)
`

type CreateDefaultEventTypeParams struct {
	ID          string
	Name        string
	Description pgtype.Text
	Category    pgtype.Text
	ProjectID   string
	JsonSchema  []byte
}

func (q *Queries) CreateDefaultEventType(ctx context.Context, arg CreateDefaultEventTypeParams) error {
	_, err := q.db.Exec(ctx, createDefaultEventType,
		arg.ID,
		arg.Name,
		arg.Description,
		arg.Category,
		arg.ProjectID,
		arg.JsonSchema,
	)
	return err
}

const createEventType = `-- name: CreateEventType :exec


INSERT INTO convoy.event_types (
    id, name, description, category, project_id, json_schema, created_at, updated_at
) VALUES (
    $1, $2, $3, $4, $5, $6, NOW(), NOW()
)
`

type CreateEventTypeParams struct {
	ID          string
	Name        string
	Description pgtype.Text
	Category    pgtype.Text
	ProjectID   string
	JsonSchema  []byte
}

// Event Types Queries
// Schema: convoy.event_types
// Columns: id, name, description, category, project_id, json_schema, created_at, updated_at, deprecated_at
// ============================================================================
// CREATE Operations
// ============================================================================
func (q *Queries) CreateEventType(ctx context.Context, arg CreateEventTypeParams) error {
	_, err := q.db.Exec(ctx, createEventType,
		arg.ID,
		arg.Name,
		arg.Description,
		arg.Category,
		arg.ProjectID,
		arg.JsonSchema,
	)
	return err
}

const deprecateEventType = `-- name: DeprecateEventType :one
UPDATE convoy.event_types
SET
    deprecated_at = NOW()
WHERE id = $1 AND project_id = $2
RETURNING
    id,
    name,
    description,
    category,
    project_id,
    json_schema,
    created_at,
    updated_at,
    deprecated_at
`

type DeprecateEventTypeParams struct {
	ID        string
	ProjectID string
}

type DeprecateEventTypeRow struct {
	ID           string
	Name         string
	Description  pgtype.Text
	Category     pgtype.Text
	ProjectID    string
	JsonSchema   []byte
	CreatedAt    pgtype.Timestamptz
	UpdatedAt    pgtype.Timestamptz
	DeprecatedAt pgtype.Timestamptz
}

func (q *Queries) DeprecateEventType(ctx context.Context, arg DeprecateEventTypeParams) (DeprecateEventTypeRow, error) {
	row := q.db.QueryRow(ctx, deprecateEventType, arg.ID, arg.ProjectID)
	var i DeprecateEventTypeRow
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Description,
		&i.Category,
		&i.ProjectID,
		&i.JsonSchema,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.DeprecatedAt,
	)
	return i, err
}

const fetchAllEventTypes = `-- name: FetchAllEventTypes :many

SELECT
    id,
    name,
    description,
    category,
    project_id,
    json_schema,
    created_at,
    updated_at,
    deprecated_at
FROM convoy.event_types
WHERE project_id = $1
ORDER BY created_at DESC
`

type FetchAllEventTypesRow struct {
	ID           string
	Name         string
	Description  pgtype.Text
	Category     pgtype.Text
	ProjectID    string
	JsonSchema   []byte
	CreatedAt    pgtype.Timestamptz
	UpdatedAt    pgtype.Timestamptz
	DeprecatedAt pgtype.Timestamptz
}

// ============================================================================
// READ Operations - Multiple Records
// ============================================================================
func (q *Queries) FetchAllEventTypes(ctx context.Context, projectID string) ([]FetchAllEventTypesRow, error) {
	rows, err := q.db.Query(ctx, fetchAllEventTypes, projectID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []FetchAllEventTypesRow
	for rows.Next() {
		var i FetchAllEventTypesRow
		if err := rows.Scan(
			&i.ID,
			&i.Name,
			&i.Description,
			&i.Category,
			&i.ProjectID,
			&i.JsonSchema,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.DeprecatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const fetchEventTypeByID = `-- name: FetchEventTypeByID :one

SELECT
    id,
    name,
    description,
    category,
    project_id,
    json_schema,
    created_at,
    updated_at,
    deprecated_at
FROM convoy.event_types
WHERE id = $1 AND project_id = $2
`

type FetchEventTypeByIDParams struct {
	ID        string
	ProjectID string
}

type FetchEventTypeByIDRow struct {
	ID           string
	Name         string
	Description  pgtype.Text
	Category     pgtype.Text
	ProjectID    string
	JsonSchema   []byte
	CreatedAt    pgtype.Timestamptz
	UpdatedAt    pgtype.Timestamptz
	DeprecatedAt pgtype.Timestamptz
}

// ============================================================================
// READ Operations - Single Record
// ============================================================================
func (q *Queries) FetchEventTypeByID(ctx context.Context, arg FetchEventTypeByIDParams) (FetchEventTypeByIDRow, error) {
	row := q.db.QueryRow(ctx, fetchEventTypeByID, arg.ID, arg.ProjectID)
	var i FetchEventTypeByIDRow
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Description,
		&i.Category,
		&i.ProjectID,
		&i.JsonSchema,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.DeprecatedAt,
	)
	return i, err
}

const fetchEventTypeByName = `-- name: FetchEventTypeByName :one
SELECT
    id,
    name,
    description,
    category,
    project_id,
    json_schema,
    created_at,
    updated_at,
    deprecated_at
FROM convoy.event_types
WHERE name = $1 AND project_id = $2
`

type FetchEventTypeByNameParams struct {
	Name      string
	ProjectID string
}

type FetchEventTypeByNameRow struct {
	ID           string
	Name         string
	Description  pgtype.Text
	Category     pgtype.Text
	ProjectID    string
	JsonSchema   []byte
	CreatedAt    pgtype.Timestamptz
	UpdatedAt    pgtype.Timestamptz
	DeprecatedAt pgtype.Timestamptz
}

func (q *Queries) FetchEventTypeByName(ctx context.Context, arg FetchEventTypeByNameParams) (FetchEventTypeByNameRow, error) {
	row := q.db.QueryRow(ctx, fetchEventTypeByName, arg.Name, arg.ProjectID)
	var i FetchEventTypeByNameRow
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Description,
		&i.Category,
		&i.ProjectID,
		&i.JsonSchema,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.DeprecatedAt,
	)
	return i, err
}

const updateEventType = `-- name: UpdateEventType :execresult

UPDATE convoy.event_types
SET
    description = $1,
    category = $2,
    json_schema = $3,
    updated_at = NOW()
WHERE id = $4 AND project_id = $5
`

type UpdateEventTypeParams struct {
	Description pgtype.Text
	Category    pgtype.Text
	JsonSchema  []byte
	ID          string
	ProjectID   string
}

// ============================================================================
// UPDATE Operations
// ============================================================================
func (q *Queries) UpdateEventType(ctx context.Context, arg UpdateEventTypeParams) (pgconn.CommandTag, error) {
	return q.db.Exec(ctx, updateEventType,
		arg.Description,
		arg.Category,
		arg.JsonSchema,
		arg.ID,
		arg.ProjectID,
	)
}
