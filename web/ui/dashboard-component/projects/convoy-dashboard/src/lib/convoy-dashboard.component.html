<convoy-notification></convoy-notification>
<div class="dashboard" [hidden]="!renderDashboard">
	<div class="dashboard--page">
		<div class="dashboard--page--head">
			<div class="filter without-padding" [ngClass]="{ 'show-calendar': showFilterCalendar }">
				<div class="margin-right__10px">Filter by:</div>

				<div class="dropdown">
					<button
						[ngClass]="{ active: (statsDateRange.value.startDate !== '' && statsDateRange.value.endDate !== '') || selectedEventsDateOption }"
						class="button button__filter button--has-icon icon-left icon-right"
						(click)="showOverlay = true; showDateFilterDropdown = !showDateFilterDropdown"
					>
						<img src="/assets/img/calendar-icon.svg" alt="calender icon" />
						<span class="color__grey margin-right__4px">Date:</span>
						<span class="color__primary" *ngIf="statsDateRange.value.startDate === '' && statsDateRange.value.endDate === ''">All Time</span>
						<mat-date-range-input [formGroup]="statsDateRange" [rangePicker]="statsPicker">
							<input matStartDate formControlName="startDate" placeholder="Start date" />
							<input
								matEndDate
								formControlName="endDate"
								placeholder="End date"
								(dateChange)="selectedDateOption = formatDate(statsDateRange.value.startDate) + ' - ' + formatDate(statsDateRange.value.endDate); fetchDashboardData()"
							/>
						</mat-date-range-input>
						<mat-date-range-picker #statsPicker [disabled]="false"></mat-date-range-picker>
						<img src="/assets/img/angle-arrow-down.svg" class="margin-right__0px" alt="arrow down icon" />
					</button>

					<div [ngClass]="{ show: showDateFilterDropdown }" class="dropdown__menu">
						<ul>
							<li
								[ngClass]="{ active: selectedDateOption == dateOption }"
								*ngFor="let dateOption of dateOptions"
								(click)="getSelectedDate(dateOption); showDateFilterDropdown = false; showOverlay = false"
							>
								From {{ dateOption }}
							</li>
							<li (click)="statsPicker.open(); showDateFilterDropdown = false; showOverlay = false">Custom Option</li>
							<!-- to be reviewed  -->
							<!-- <li class="no-hover flex flex__align-items-center">
                                <button class="button button__primary button__small margin-right__14px" (click)="fetchDashboardData(); showDateFilterDropdown = false">Apply</button>
                                <button class="button__clear" (click)="selectedDateOption = ''; showDateFilterDropdown = false">Clear</button>
                            </li> -->
						</ul>
					</div>
				</div>

				<div class="dropdown">
					<button class="button button__filter button--has-icon icon-right margin-left__16px" (click)="showFilterDropdown = !showFilterDropdown; showOverlay = true">
						<span class="color__grey margin-right__4px">Filter By:</span>
						<span class="color__primary text__capitalize">{{ dashboardFrequency }}</span>
						<img src="/assets/img/angle-arrow-down.svg" alt="arrow down icon" />
					</button>

					<div class="dropdown__menu dropdown__menu__push-left" [ngClass]="{ show: showFilterDropdown }">
						<ul>
							<li
								class="text__capitalize"
								[ngClass]="{ active: dashboardFrequency == filterOption }"
								*ngFor="let filterOption of filterOptions"
								(click)="dashboardFrequency = filterOption; fetchDashboardData(); showFilterDropdown = false; showOverlay = false"
							>
								{{ filterOption }}
							</li>
						</ul>
					</div>
				</div>
			</div>

			<ng-container *ngIf="!isCloud">
				<div class="flex flex__align-items-center">
					<div>Active Group:</div>
					<button class="button button__filter button--has-icon icon-right margin-left__16px flex flex__align-items-center flex__justify-between group-dropdown" (click)="showProjectsModal = true">
						<span class="color__primary has-ellipsis">{{ selectedGroupName() }}</span>
						<img src="/assets/img/angle-arrow-down.svg" alt="arrow down icon" />
					</button>
				</div>
			</ng-container>
		</div>

		<div class="dashboard--page--details">
			<div class="card has-title dashboard--page--details--chart has-loader">
				<convoy-loader id="dashboard_summary_loader" *ngIf="isloadingDashboardData"></convoy-loader>

				<ul class="metrics">
					<li class="flex flex__align-items-center padding-x__30px padding-y__16px border__none">
						<img src="/assets/img/message-icon.svg" alt="message icon" />
						<div class="metric">
							<div>{{ dashboardData.events_sent | metric }}</div>
							<div class="color__grey">Event Sent</div>
						</div>
					</li>
					<li class="flex flex__align-items-center padding-x__30px padding-y__16px">
						<img src="/assets/img/apps-icon.svg" alt="apps icon" />
						<div class="metric">
							<div>{{ dashboardData.apps | metric }}</div>
							<div class="color__grey">Apps</div>
						</div>
					</li>
				</ul>

				<div>
					<canvas id="dahboard_events_chart" width="400" height="200"></canvas>
				</div>
			</div>

			<div class="card has-title dashboard--page--details--credentials has-loader">
				<div class="card--title">
					<h3>Configuration</h3>
				</div>

				<ul class="card--container" id="group_config_loader" *ngIf="isloadingConfig">
					<li class="list-item-inline">
						<div class="list-item-inline--label"><div class="skeleton-loader data"></div></div>
						<div class="list-item-inline--item">
							<div class="skeleton-loader small"></div>
						</div>
					</li>

					<li class="list-item-inline border__top">
						<div class="list-item-inline--label padding-top__16px"><div class="skeleton-loader small"></div></div>
						<div class="list-item-inline--item padding-top__16px"><div class="skeleton-loader small"></div></div>
					</li>

					<li class="list-item-inline border__top">
						<div class="list-item-inline--label padding-top__16px"><div class="skeleton-loader text"></div></div>
						<div class="list-item-inline--item padding-top__16px">
							<div class="flex flex__column flex__justify-end flex__align-items-end">
								<div class="skeleton-loader data"></div>
								<div class="skeleton-loader small margin-top__8px"></div>
							</div>
						</div>
					</li>

					<li class="list-item-inline border__top">
						<div class="list-item-inline--label padding-top__16px"><div class="skeleton-loader text"></div></div>
						<div class="list-item-inline--item padding-top__16px"><div class="skeleton-loader small"></div></div>
					</li>
				</ul>

				<ul class="card--container" id="group-config" *ngIf="!isloadingConfig">
					<li class="list-item-inline">
						<div class="list-item-inline--label">Request interval (Seconds)</div>
						<div class="list-item-inline--item">{{ organisationDetails?.strategy?.default?.intervalSeconds }}s</div>
					</li>

					<li class="list-item-inline border__top">
						<div class="list-item-inline--label padding-top__16px">Retry limit</div>
						<div class="list-item-inline--item padding-top__16px">{{ organisationDetails?.strategy?.default?.retryLimit }}</div>
					</li>

					<li class="list-item-inline border__top">
						<div class="list-item-inline--label padding-top__16px">Signature header</div>
						<div class="list-item-inline--item padding-top__16px">{{ organisationDetails?.signature?.header }}</div>
					</li>

					<li class="list-item-inline border__top">
						<div class="list-item-inline--label padding-top__16px">Signature hash</div>
						<div class="list-item-inline--item padding-top__16px">{{ organisationDetails?.signature?.hash }}</div>
					</li>
				</ul>
			</div>
		</div>

		<section class="card has-title dashboard--logs">
			<div class="dashboard--logs--tabs">
				<div class="tabs flex__align-items-center">
					<li *ngFor="let tab of tabs" (click)="toggleActiveTab(tab)">
						<button [ngClass]="{ active: activeTab === tab }">
							<span>{{ tab }}</span>
						</button>
					</li>
					<div class="color__grey font__14px font__weight-500 font--nowrap margin-left--auto padding-right__14px">
						<span *ngIf="events" [hidden]="activeTab !== 'events'">
							{{ events && events.pagination.total > 0 ? 1 : 0 }} - {{ events && events.pagination.total < 20 ? events.pagination.total : events?.content?.length }}
							<strong>of</strong>
							{{ events.pagination.total | metric }}
						</span>
						<span *ngIf="eventDeliveries" [hidden]="activeTab !== 'event deliveries'">
							{{ eventDeliveries && eventDeliveries.pagination.total > 0 ? 1 : 0 }} -
							{{ eventDeliveries && eventDeliveries.pagination.total < 20 ? eventDeliveries.pagination.total : eventDeliveries?.content?.length }}
							<strong>of</strong>
							{{ eventDeliveries.pagination.total | metric }}
						</span>
						<span *ngIf="apps" [hidden]="activeTab !== 'apps'">
							{{ apps && apps.pagination.total > 0 ? 1 : 0 }} - {{ apps && apps.pagination.total < 20 ? apps.pagination.total : apps?.content?.length }}
							<strong>of</strong>
							{{ apps.pagination.total | metric }}
						</span>
					</div>
				</div>
			</div>

			<div class="dashboard--logs--filter">
				<div [hidden]="activeTab !== 'events'">
					<div class="flex flex__align-items-center flex__justify-between">
						<div class="flex">
							<form class="input__search margin-bottom__0px events-search">
								<img src="/assets/img/search-icon.svg" alt="search icon" />
								<input
									type="search"
									placeholder="Search events"
									[(ngModel)]="eventsSearchString"
									(change)="eventsPage = 1; getEvents({ addToURL: true, fromFilter: true })"
									[ngModelOptions]="{ standalone: true }"
								/>
								<button [class]="'enter-button' + (eventsSearchString.length > 0 ? ' show' : '')" (click)="eventsPage = 1; getEvents({ addToURL: true, fromFilter: true })">
									<img src="/assets/img/enter-icon.png" alt="enter icon" />
								</button>
							</form>

							<div class="dropdown margin-left__24px">
								<button
									class="button button__filter without-margin button--has-icon icon-left icon-right"
									[ngClass]="{ active: (eventsFilterDateRange.value.startDate !== '' && eventsFilterDateRange.value.endDate !== '') || selectedEventsDateOption }"
									(click)="showEventFilterCalendar = !showEventFilterCalendar; showOverlay = true"
								>
									<img class="margin-left__0px" src="/assets/img/calendar-icon.svg" alt="calender icon" />
									<span class="margin-right__4px color__primary font__weight-500" *ngIf="eventsFilterDateRange.value.startDate === '' && eventsFilterDateRange.value.endDate === ''">
										All Time
									</span>
									<mat-date-range-input [formGroup]="eventsFilterDateRange" [rangePicker]="eventsFilterPicker">
										<input matStartDate formControlName="startDate" />
										<input
											matEndDate
											formControlName="endDate"
											(dateChange)="
												selectedEventsDateOption = formatDate(eventsFilterDateRange.value.startDate) + ' - ' + formatDate(eventsFilterDateRange.value.endDate);
												getEvents({ addToURL: true, fromFilter: true })
											"
										/>
									</mat-date-range-input>
									<mat-date-range-picker #eventsFilterPicker [disabled]="false"></mat-date-range-picker>
									<img class="margin-right__0px" src="/assets/img/angle-arrow-down.svg" alt="arrow down icon" />
								</button>

								<div [ngClass]="{ show: showEventFilterCalendar }" class="dropdown__menu large">
									<ul>
										<li
											[ngClass]="{ active: selectedEventsDateOption == dateOption }"
											*ngFor="let dateOption of dateOptions"
											(click)="getSelectedDate(dateOption, activeTab); showEventFilterCalendar = false; showOverlay = false"
										>
											From {{ dateOption }}
										</li>
										<li (click)="eventsFilterPicker.open(); showEventFilterCalendar = false; showOverlay = false">Custom Option</li>
									</ul>
								</div>
							</div>

							<time-filter (applyFilter)="eventsTimeFilterData = $event; getEvents({ addToURL: true, fromFilter: true })" #eventsTimeFilter></time-filter>

							<div class="dropdown margin-left__24px">
								<button
									class="button button__filter button--has-icon icon-left"
									[ngClass]="{ active: !!eventApp }"
									(click)="showOverlay = true; showEventsAppsDropdown = !showEventsAppsDropdown"
								>
									<img src="/assets/img/apps-icon-grey.svg" alt="apps filter icon" />
									<span>All Apps</span>
									<img class="margin-left__30px margin-right__0px" src="/assets/img/angle-arrow-down.svg" alt="arrow down icon" />
								</button>

								<div class="dropdown__menu with-padding large" [ngClass]="{ show: showEventsAppsDropdown }">
									<div class="input__search">
										<img src="/assets/img/search-icon.svg" alt="search icon" />
										<input type="search" placeholder="Search apps here" #eventsAppsFilter />
									</div>

									<li class="dropdown__menu__item border__bottom" *ngFor="let app of eventsAppsFilter$ | async">
										<label [for]="app.uid">{{ app.name }}</label>
										<input type="checkbox" name="app" [value]="app.uid" [id]="app.uid" [checked]="app.uid === eventApp" (change)="updateAppFilter(app.uid, $event, 'events')" />
									</li>

									<div *ngIf="filteredApps?.length !== 0 && !!eventApp" class="margin-top__10px">
										<button class="button button__clear button__small" (click)="clearEventFilters(activeTab, 'eventsApp'); showEventsAppsDropdown = false">Clear</button>
									</div>

									<p *ngIf="filteredApps?.length === 0">No app to display</p>
								</div>
							</div>
						</div>

						<button
							class="button button__white button__small margin-right__20px"
							(click)="clearEventFilters(activeTab); selectedEventsDateOption = ''"
							[disabled]="
								(eventsFilterDateRange.value.startDate == '' || eventsFilterDateRange.value.endDate == '') &&
								eventApp == '' &&
								eventsSearchString.length == 0 &&
								eventsTimeFilterData.startTime == 'T00:00:00' &&
								eventsTimeFilterData.endTime == 'T23:59:59'
							"
						>
							Clear Filter
						</button>
					</div>
				</div>

				<div [hidden]="activeTab !== 'event deliveries'">
					<div class="flex flex__align-items-center flex__justify-between">
						<div class="flex">
							<div class="dropdown">
								<button
									class="button button__filter without-margin button--has-icon icon-right icon-left"
									[ngClass]="{ active: (eventDeliveriesFilterDateRange.value.startDate !== '' && eventDeliveriesFilterDateRange.value.endDate !== '') || selectedEventsDelDateOption }"
									(click)="showOverlay = true; showEventDelFilterCalendar = !showEventDelFilterCalendar"
								>
									<img class="margin-left__0px" src="/assets/img/calendar-icon.svg" alt="calender icon" />
									<span class="color__primary font__weight-500" *ngIf="eventDeliveriesFilterDateRange.value.startDate === '' && eventDeliveriesFilterDateRange.value.endDate === ''">
										All Time
									</span>
									<!-- to be reviewed  -->
									<!-- <span class="color__primary" *ngIf="selectedEventsDelDateOption">: {{ selectedEventsDelDateOption }}</span> -->
									<mat-date-range-input [formGroup]="eventDeliveriesFilterDateRange" [rangePicker]="eventDeliveriesFilterPicker">
										<input matStartDate formControlName="startDate" />
										<input
											matEndDate
											formControlName="endDate"
											(dateChange)="
												selectedEventsDelDateOption = formatDate(eventDeliveriesFilterDateRange.value.startDate) + ' - ' + formatDate(eventDeliveriesFilterDateRange.value.endDate);
												getEventDeliveries({ addToURL: true, fromFilter: true })
											"
										/>
									</mat-date-range-input>
									<mat-date-range-picker #eventDeliveriesFilterPicker [disabled]="false"></mat-date-range-picker>
									<img class="margin-right__0px" src="/assets/img/angle-arrow-down.svg" alt="arrow down icon" />
								</button>

								<div [ngClass]="{ show: showEventDelFilterCalendar }" class="dropdown__menu large">
									<ul>
										<li
											[ngClass]="{ active: selectedEventsDelDateOption == dateOption }"
											*ngFor="let dateOption of dateOptions"
											(click)="getSelectedDate(dateOption, activeTab); showEventDelFilterCalendar = false"
										>
											From {{ dateOption }}
										</li>
										<li (click)="eventDeliveriesFilterPicker.open(); showEventDelFilterCalendar = false; showOverlay = false">Custom Option</li>
										<!-- to be reviewed  -->
										<!-- <li class="no-hover flex flex__align-items-center">
                                            <button
                                                class="button button__primary button__small margin-right__14px"
                                                (click)="getEventDeliveries({ addToURL: true, fromFilter: true }); showEventDelFilterCalendar = false"
                                            >
                                                Apply
                                            </button>
                                            <button class="button__clear" (click)="selectedEventsDelDateOption = ''; clearEventFilters(activeTab, 'eventsDelDate'); showEventDelFilterCalendar = false">
                                                Clear
                                            </button>
                                        </li> -->
									</ul>
								</div>
							</div>

							<time-filter (applyFilter)="eventDelsTimeFilterData = $event; getEventDeliveries({ addToURL: true, fromFilter: true })" #eventDeliveryTimerFilter></time-filter>

							<div class="dropdown margin-left__24px">
								<button
									class="button button__filter button--has-icon icon-left"
									[ngClass]="{ active: eventDeliveryFilteredByStatus.length > 0 }"
									(click)="showOverlay = true; showEventDeliveriesStatusDropdown = !showEventDeliveriesStatusDropdown"
								>
									<img class="margin-left__0px" src="/assets/img/status-filter-icon.svg" alt="status filter icon" />
									<span class="font__weight-500">Status</span>
									<img class="margin-left__16px margin-right__0px" src="/assets/img/angle-arrow-down.svg" alt="arrow down icon" />
								</button>

								<div class="dropdown__menu with-padding small" [ngClass]="{ show: showEventDeliveriesStatusDropdown }">
									<div class="dropdown__menu__item with-border" *ngFor="let status of eventDeliveryStatuses">
										<label [for]="status">{{ status || 'None' }}</label>
										<input
											type="checkbox"
											name="status"
											[value]="status"
											[id]="status"
											[checked]="checkIfEventDeliveryStatusFilterOptionIsSelected(status)"
											(change)="updateEventDevliveryStatusFilter(status, $event)"
										/>
									</div>

									<div class="flex flex__align-items-center margin-top__10px">
										<button
											class="button button__small button__primary font__12px margin-right__10px"
											(click)="showOverlay = false; showEventDeliveriesStatusDropdown = false; this.getEventDeliveries({ addToURL: true, fromFilter: true })"
										>
											Apply
										</button>
										<button class="button__clear" (click)="clearEventFilters(activeTab, 'eventsDelsStatus'); showEventDeliveriesStatusDropdown = false; showOverlay = false">Clear</button>
									</div>
								</div>
							</div>

							<div class="dropdown margin-left__24px">
								<button
									class="button button__filter button--has-icon icon-left"
									[ngClass]="{ active: !!eventDeliveriesApp }"
									(click)="showOverlay = true; showEventDeliveriesAppsDropdown = !showEventDeliveriesAppsDropdown"
								>
									<img class="margin-left__0px" src="/assets/img/apps-icon-grey.svg" alt="apps filter icon" />
									<span class="font__weight-500">All Apps</span>
									<img class="margin-left__16px margin-right__0px" src="/assets/img/angle-arrow-down.svg" alt="arrow down icon" />
								</button>

								<div class="dropdown__menu large with-padding" [ngClass]="{ show: showEventDeliveriesAppsDropdown }">
									<div class="input__search">
										<img src="/assets/img/search-icon.svg" alt="search icon" />
										<input type="search" placeholder="Search apps here" #eventDelsAppsFilter />
									</div>

									<div class="dropdown__menu__item with-border" *ngFor="let app of eventsDelAppsFilter$ | async">
										<label [for]="app.uid + 'eventDel'">{{ app.name }}</label>
										<input
											type="checkbox"
											name="app"
											[value]="app.uid"
											[id]="app.uid + 'eventDel'"
											[checked]="app.uid === eventDeliveriesApp"
											(change)="updateAppFilter(app.uid, $event, 'eventDels')"
										/>
									</div>
									<div *ngIf="filteredApps?.length !== 0 && !!eventDeliveriesApp" class="margin-top__10px">
										<button class="button button__clear button__small" (click)="clearEventFilters(activeTab, 'eventsDelApp'); showEventDeliveriesAppsDropdown = false; showOverlay = false">
											Clear
										</button>
									</div>
									<p *ngIf="filteredApps?.length === 0">No app to display</p>
								</div>
							</div>

							<div class="button__filter active margin-left__24px" *ngIf="eventDeliveryFilteredByEventId !== ''">
								Event Filtered
								<button class="button__clear button--has-icon margin-left__8px" (click)="eventDeliveryFilteredByEventId = ''; getEventDeliveries()">
									<img src="../../../../assets/img/close-icon.svg" alt="close icon" />
								</button>
							</div>

							<button
								class="button button__filter margin-left__24px flex__justify-center"
								(click)="fetchRetryCount()"
								[ngClass]="{
									disabled:
										((eventDeliveriesFilterDateRange.value.startDate == '' || eventDeliveriesFilterDateRange.value.endDate == '') &&
											eventDeliveriesApp == '' &&
											eventDeliveryFilteredByEventId == '' &&
											!eventDeliveriesStatusFilterActive) ||
										fetchingCount
								}"
							>
								Batch Retry
							</button>
						</div>

						<button
							class="button button__white button__small font__12px margin-right__20px"
							(click)="clearEventFilters(activeTab); selectedEventsDelDateOption = ''"
							[ngClass]="{
								disabled:
									(eventDeliveriesFilterDateRange.value.startDate == '' || eventDeliveriesFilterDateRange.value.endDate == '') &&
									eventDeliveriesApp == '' &&
									eventDeliveryFilteredByEventId == '' &&
									!eventDeliveriesStatusFilterActive &&
									eventDelsTimeFilterData.startTime == 'T00:00:00' &&
									eventDelsTimeFilterData.endTime == 'T23:59:59'
							}"
						>
							Clear Filter
						</button>
					</div>
				</div>

				<div [hidden]="activeTab !== 'apps'">
					<div class="flex flex__align-items-center flex__justify-between">
						<div class="flex flex__align-items-center">
							<form class="input__search margin-bottom__0px">
								<img src="/assets/img/search-icon.svg" alt="search icon" />
								<input
									type="search"
									placeholder="Search apps"
									[(ngModel)]="appsSearchString"
									(change)="searchApps({ searchInput: $event, type: 'apps' })"
									[ngModelOptions]="{ standalone: true }"
								/>
								<button [class]="'enter-button' + (appsSearchString.length > 0 ? ' show' : '')" (click)="searchApps({ type: 'apps' })">
									<img src="/assets/img/enter-icon.png" alt="enter icon" />
								</button>
							</form>

							<!-- pending when backend is ready  -->
							<!-- <div class="dropdown margin-left__24px">
								<button
									class="button button__filter button--has-icon icon-right icon-left"
									[ngClass]="{ active: selectedAppStatus !== 'All' }"
									(click)="showOverlay = true; showEventDeliveriesStatusDropdown = !showEventDeliveriesStatusDropdown"
								>
									<img class="margin-left__0px" src="/assets/img/status-filter-icon.svg" alt="status filter icon" />
									<span>Status</span>
									<span class="color__grey">:</span>
									<span class="color__primary font__14px font__weight-500 margin-left__8px" *ngIf="selectedAppStatus">{{selectedAppStatus}}</span>
									<img class="margin-right__0px" src="/assets/img/angle-arrow-down.svg" alt="arrow down icon" />
								</button>

								<div class="dropdown__menu with-padding small" [ngClass]="{ show: showEventDeliveriesStatusDropdown }">
									<div class="dropdown__menu__item with-border" *ngFor="let status of appStatuses">
										<label [for]="status">{{ status || 'None' }}</label>
										<input
											type="checkbox"
											name="status"
											[value]="status"
											[id]="status"
											[checked]="selectedAppStatus == status"
											(change)="filterAppByStatus(status)"
										/>
									</div>

									<div class="flex flex__align-items-center margin-top__10px">
										<button class="button__clear" (click)="clearEventFilters(activeTab); showEventDeliveriesStatusDropdown = false; showOverlay = false">Clear</button>
									</div>
								</div>
							</div> -->
						</div>
						<button class="button button__primary button__small" id="create-app-modal-button" (click)="showCreateAppModal = !showCreateAppModal">Create App</button>
					</div>
				</div>
			</div>

			<div class="flex">
				<div class="dashboard--logs--table" [ngClass]="{ 'width-100': activeTab !== 'events' }">
					<convoy-table-loader id="events_loader_loader" [tableHead]="eventsTableHead" *ngIf="isloadingEvents && activeTab === 'events'"></convoy-table-loader>
					<div class="table table--container has-loader" id="events-table-container" [hidden]="activeTab !== 'events' || displayedEvents?.length === 0">
						<table id="table" *ngIf="!isloadingEvents">
							<thead>
								<tr class="table--head">
									<th *ngFor="let head of eventsTableHead" scope="col">{{ head }}</th>
								</tr>
							</thead>
							<tbody>
								<ng-container *ngFor="let eventGroup of displayedEvents; let i = index">
									<tr class="table--date-row">
										<td>
											<div>{{ eventGroup.date }}</div>
										</td>
										<td></td>
										<td></td>
										<td></td>
									</tr>
									<tr
										*ngFor="let event of eventGroup.content; let index = index"
										[ngClass]="{ active: event.uid === eventsDetailsItem?.uid, 'last-item': index === eventGroup.content.length - 1 }"
										[id]="'event' + i"
										(click)="eventsDetailsItem = event; getEventDeliveriesForSidebar(event.uid)"
									>
										<td>
											<div>
												<div class="tag tag--Neutral">{{ event.event_type }}</div>
											</div>
										</td>
										<td>
											<div class="long-text long-text__150px">
												<span class="underline color__primary" (click)="openAppsTabAndDetails(event.app_metadata.title)">{{ event.app_metadata.title }}</span>
											</div>
										</td>
										<td>
											<div>{{ event.created_at | date: 'mediumTime' }}</div>
										</td>
										<td>
											<div>
												<button class="button__clear button--has-icon icon-right" (click)="eventDeliveryFilteredByEventId = event.uid; openDeliveriesTab()">
													Deliveries
													<img src="../../../../assets/img/angle-arrow-right-primary.svg" alt="arrow right" />
												</button>
											</div>
										</td>
									</tr>
								</ng-container>
							</tbody>
						</table>

						<div class="table--load-more button--container center" *ngIf="events && events.pagination.totalPage > 1 && !isloadingEvents">
							<button
								class="button button__clear button--has-icon icon-left margin-top__20px margin-bottom__24px flex__justify-center"
								[disabled]="events.pagination.page === events.pagination.totalPage || isloadingMoreEvents"
								(click)="eventsPage = eventsPage + 1; getEvents()"
							>
								<img src="/assets/img/arrow-down-icon.svg" class="width-unset height-unset" [hidden]="isloadingMoreEvents" alt="arrow down icon" />
								<img src="/assets/img/rotate-icon.svg" class="loading-icon" [hidden]="!isloadingMoreEvents" alt="loading icon" />
								Load more
							</button>
						</div>
					</div>

					<div class="empty-state table--container" id="events-empty-state" *ngIf="displayedEvents?.length === 0 && activeTab === 'events'">
						<img src="/assets/img/empty-state-img.svg" alt="empty state" />
						<p>No event to show here</p>
					</div>

					<convoy-table-loader id="event_deliveries_loader" [tableHead]="eventDelTableHead" *ngIf="isloadingEventDeliveries && activeTab === 'event deliveries'"></convoy-table-loader>
					<div class="table table--container has-loader" id="event-deliveries-table-container" [hidden]="activeTab !== 'event deliveries' || displayedEventDeliveries.length === 0">
						<table id="table" *ngIf="!isloadingEventDeliveries">
							<thead>
								<tr class="table--head">
									<th *ngFor="let head of eventDelTableHead" scope="col">{{ head }}</th>
								</tr>
							</thead>
							<tbody>
								<ng-container *ngFor="let eventDeliveriesGroup of displayedEventDeliveries; let i = index">
									<tr class="table--date-row">
										<td>
											<div>{{ eventDeliveriesGroup.date }}</div>
										</td>
										<td></td>
										<td></td>
										<td></td>
										<td></td>
										<td></td>
									</tr>
									<tr
										*ngFor="let event of eventDeliveriesGroup.content; let index = index"
										[ngClass]="{ 'last-item': index === eventDeliveriesGroup.content.length - 1, active: event.uid === eventDelsDetailsItem?.uid }"
										[id]="'eventDel' + i"
										(click)="eventDelsDetailsItem = event; getDelieveryAttempts(event.uid); eventDeliveryIndex = index; toggleDashboard()"
									>
										<td>
											<div class="has-retry">
												<img *ngIf="event.metadata.num_trials > event.metadata.retry_limit" src="/assets/img/retry-icon.svg" alt="retry icon" title="manually retried" />
												<div [class]="'tag tag--' + event.status">{{ event.status }}</div>
											</div>
										</td>
										<td>
											<div>
												<div class="tag tag--Neutral">{{ event.event_metadata.name }}</div>
											</div>
										</td>
										<td>
											<div>{{ event.metadata?.num_trials }}</div>
										</td>
										<td>
											<div>{{ event.created_at | date: 'mediumTime' }}</div>
										</td>
										<td>
											<div>
												<button
													[disabled]="event.status !== 'Failure' && event.status !== 'Success'"
													[class]="'button__retry button--has-icon icon-left '"
													(click)="
														event.status === 'Success'
															? forceRetryEvent({ e: $event, index: this.index, eventDeliveryId: event.uid })
															: retryEvent({ e: $event, index: this.index, eventDeliveryId: event.uid })
													"
												>
													<img src="/assets/img/refresh-icon-primary.svg" alt="refresh icon" />

													{{ event.status === 'Success' ? 'Force Retry' : 'Retry' }}
												</button>
											</div>
										</td>
										<td class="width__5">
											<div>
												<button
													class="button__clear button--has-icon icon-right"
													(click)="eventDelsDetailsItem = event; getDelieveryAttempts(event.uid); eventDeliveryIndex = index; toggleDashboard()"
												>
													<img src="../../../../assets/img/angle-arrow-right-primary.svg" alt="arrow right" />
												</button>
											</div>
										</td>
									</tr>
								</ng-container>
							</tbody>
						</table>

						<div class="table--load-more button--container center" *ngIf="eventDeliveries && eventDeliveries.pagination.totalPage > 1 && !isloadingEventDeliveries">
							<button
								class="button button__clear button--has-icon icon-left margin-top__24px margin-bottom__24px flex__justify-center"
								[disabled]="eventDeliveries.pagination.page === eventDeliveries.pagination.totalPage || isloadingMoreEventDeliveries"
								(click)="loadMoreEventDeliveries()"
							>
								<img src="/assets/img/arrow-down-icon.svg" class="width-unset height-unset" [hidden]="isloadingMoreEventDeliveries" alt="arrow down icon" />
								<img src="/assets/img/rotate-icon.svg" class="loading-icon" [hidden]="!isloadingMoreEventDeliveries" alt="loading icon" />
								Load more
							</button>
						</div>
					</div>

					<div class="empty-state table--container" id="event-deliveries-empty-state" *ngIf="displayedEventDeliveries.length === 0 && activeTab === 'event deliveries'">
						<img src="/assets/img/empty-state-img.svg" alt="empty state" />
						<p>No event to show here</p>
					</div>

					<convoy-table-loader id="apps_loader" [tableHead]="appsTableHead" *ngIf="isloadingApps && activeTab === 'apps'"></convoy-table-loader>
					<div class="table table--container has-loader" id="apps-table-container" [hidden]="activeTab !== 'apps' || displayedApps.length === 0">
						<table id="table" *ngIf="!isloadingApps">
							<thead>
								<tr class="table--head">
									<th *ngFor="let head of appsTableHead" scope="col">{{ head }}</th>
									<th scope="col"></th>
									<th scope="col"></th>
								</tr>
							</thead>
							<tbody>
								<ng-container *ngFor="let apps of displayedApps; let i = index">
									<tr class="table--date-row">
										<td>
											<div>{{ apps.date }}</div>
										</td>
										<td></td>
										<td></td>
										<td></td>
										<td></td>
									</tr>
									<tr
										*ngFor="let app of apps?.content; let index = index"
										[id]="'app' + i"
										[ngClass]="{ active: app.uid === appsDetailsItem?.uid }"
										(click)="appsDetailsItem = app; getAppPortalToken({ redirect: false }); toggleDashboard()"
									>
										<td>
											<div class="has-retry">
												<div [class]="app.is_disabled ? 'tag no-margin' : 'tag tag--Success no-margin'">{{ app.is_disabled ? 'Disabled' : 'Enabled' }}</div>
											</div>
										</td>
										<td class="has-long-text">
											<div>{{ app.name }}</div>
										</td>
										<td>
											<div>{{ app.created_at | date: 'hh:mm:ss a' }}</div>
										</td>
										<td>
											<div>{{ app.updated_at | date }}</div>
										</td>
										<td>
											<div>{{ app.events }}</div>
										</td>
										<td>
											<div>{{ app.endpoints.length }}</div>
										</td>
										<td>
											<div>
												<button
													[disabled]="app.events <= 0"
													title="view events"
													[class]="'button__retry button--has-icon icon-left'"
													(click)="loadEventsFromAppsTable(app.uid); renderDashboard = false"
												>
													<img src="/assets/img/view-events-icon.svg" alt="view events icon" />
													Events
												</button>
											</div>
										</td>
										<td>
											<div class="dropdown">
												<button class="button__clear button--has-icon" (click)="currentAppId = app.uid; showOverlay = true; renderDashboard = false">
													<img src="/assets/img/more-icon-vertical.svg" alt="more icon" />
												</button>
												<div [ngClass]="{ show: currentAppId == app.uid }" class="dropdown__menu dropdown__menu__nav small z-index--3">
													<ul>
														<li (click)="openUpdateAppModal(app)">Update</li>
														<li (click)="showDeleteAppModal = !showDeleteAppModal; currentAppId = ''" class="danger">Delete</li>
													</ul>
												</div>
											</div>
										</td>
									</tr>
								</ng-container>
							</tbody>
						</table>

						<div class="table--load-more button--container center" *ngIf="apps?.pagination && apps.pagination.totalPage > 1 && !isloadingApps">
							<button
								[class]="
									'button button__primary button__clear button--has-icon icon-left margin-top__20px margin-bottom__24px flex__justify-center' +
									(apps.pagination.page === apps.pagination.totalPage ? 'disabled' : '')
								"
								[disabled]="apps.pagination.page === apps.pagination.totalPage || isloadingMoreApps"
								(click)="appsPage = appsPage + 1; getApps()"
							>
								<img src="/assets/img/arrow-down-icon.svg" class="width-unset height-unset" alt="arrow down icon" [hidden]="isloadingMoreApps" />
								<img src="/assets/img/rotate-icon.svg" class="loading-icon" [hidden]="!isloadingMoreApps" alt="loading icon" />
								Load more
							</button>
						</div>
					</div>

					<div class="empty-state table--container" id="apps-empty-state" *ngIf="displayedApps?.length === 0 && activeTab === 'apps'">
						<img src="/assets/img/empty-state-img.svg" alt="empty state" />
						<p>No app to show here</p>
					</div>
				</div>

				<div class="dashboard--logs--details has-loader" *ngIf="activeTab === 'events'">
					<convoy-loader id="details_section_loader" *ngIf="activeTab === 'events' && isloadingEvents"></convoy-loader>

					<ng-container *ngIf="activeTab === 'events' && eventsDetailsItem">
						<h3>Details</h3>
						<div class="dashboard--logs--details--req-res">
							<div class="dashboard--logs--details--tabs-data show">
								<h4>Event</h4>
								<prism language="json" [code]="getCodeSnippetString('event')"></prism>
							</div>
						</div>

						<h4 *ngIf="sidebarEventDeliveries && sidebarEventDeliveries.length > 0">Deliveries Overview</h4>
						<ul *ngIf="sidebarEventDeliveries && sidebarEventDeliveries.length > 0">
							<li class="flex flex__align-items-center margin-top__16px border__bottom padding-bottom__10px" *ngFor="let delivery of sidebarEventDeliveries">
								<div [class]="'margin-top__4px tag tag--' + delivery.status">{{ delivery.status }}</div>
								<div class="font__14px color__black margin-left__16px long-text long-text__300px" [title]="delivery.endpoint.target_url">
									{{ delivery.endpoint.target_url }}
								</div>
							</li>
						</ul>
					</ng-container>
				</div>
			</div>
		</section>
	</div>
</div>

<div [hidden]="renderDashboard">
	<div class="page page__small without-background padding-all__0px margin-top__30px margin-bottom__16px">
		<div class="flex flex__align-items-center flex__justify-between">
			<div class="flex flex__align-items-center">
				<button class="button__back flex flex__align-items-center flex__justify-center" (click)="toggleDashboard()">
					<img src="/assets/img/arrow-left-primary.svg" alt="arrow back" />
				</button>
				<p class="margin-bottom__0px font__16px color__black font__weight-600 margin-left__18px text__capitalize">
					{{ activeTab === 'apps' ? appsDetailsItem?.name : eventDelsDetailsItem?.app_metadata?.title }}
				</p>
			</div>
			<div *ngIf="activeTab === 'apps' && appsDetailsItem">
				<!-- app enable/disable toggle  -->
				<label class="toggle">
					<span class="toggle-label">{{ appsDetailsItem?.is_disabled ? 'App Disabled' : 'App Enabled' }}</span>
					<input class="toggle-checkbox" type="checkbox" (change)="editAppStatus(appsDetailsItem)" [checked]="!appsDetailsItem?.is_disabled" />
					<div class="toggle-switch"></div>
				</label>
			</div>
		</div>
	</div>
	<ng-container *ngIf="activeTab === 'apps' && appsDetailsItem">
		<app-details
			[appsDetailsItem]="appsDetailsItem"
			[appPortalLink]="appPortalLink"
			(loadEventsFromAppTable)="loadEventsFromAppsTable($event)"
			(openAddEndpointModal)="showAddEndpointModal = !showAddEndpointModal"
			(closeOverviewRender)="toggleDashboard()"
			(openEndpointSecretKey)="viewEndpointSecretKey($event)"
			(editAppDetails)="editAppStatus($event)"
			(fetchAppPortalToken)="getAppPortalToken($event)"
			(openAddEventModal)="setEventAppId()"
		></app-details>
	</ng-container>
	<ng-container *ngIf="activeTab === 'event deliveries' && eventDelsDetailsItem">
		<event-delivery-details
			[eventDelsDetailsItem]="eventDelsDetailsItem"
			[eventDeliveryAtempt]="eventDeliveryAtempt"
			[eventDeliveryIndex]="eventDeliveryIndex"
			(loadEventsFromAppTable)="loadEventsFromAppsTable($event)"
			(closeOverviewRender)="toggleDashboard()"
			(doForceRetryEvent)="forceRetryEvent($event)"
			(doRetryEvent)="retryEvent($event)"
		></event-delivery-details>
	</ng-container>
</div>

<div
	class="overlay"
	*ngIf="showOverlay"
	(click)="
		currentAppId = '';
		showOverlay = false;
		showEventDeliveriesStatusDropdown = false;
		showEventDeliveriesAppsDropdown = false;
		showEventsAppsDropdown = false;
		showDateFilterDropdown = false;
		showEventDelFilterCalendar = false;
		showEventFilterCalendar = false;
		showEndpointSecret = false;
		showFilterDropdown = false;
		showFilterCalendar = false
	"
></div>

<!-- dark overlay  -->
<div
	class="_overlay"
	*ngIf="showBatchRetryModal || showCreateAppModal || showAddEndpointModal || showAddEventModal || showDeleteAppModal || showEndpointSecret || showProjectsModal"
	(click)="showCreateAppModal = false; showBatchRetryModal = false; showAddEndpointModal = false; showAddEventModal = false; showDeleteAppModal = false; showEndpointSecret = false; showProjectsModal = false"
></div>

<!-- create app, add new endpoint, add event modals  -->
<div class="modal modal__right" *ngIf="showCreateAppModal || showAddEndpointModal || showAddEventModal || showEndpointSecret">
	<!-- create app modal  -->
	<div class="modal--head" *ngIf="showCreateAppModal">
		<h2>{{ editAppMode ? 'Edit App' : 'Create App' }}</h2>
		<a (click)="showCreateAppModal = false; editAppMode = false; addNewAppForm.reset()">
			<img src="/assets/img/modal-close-icon.svg" alt="close icon" />
		</a>
	</div>

	<div class="modal--body" *ngIf="showCreateAppModal">
		<form [formGroup]="addNewAppForm" id="create-app-form">
			<div class="input">
				<input id="app-name" type="text" formControlName="name" [ngClass]="{ danger: addNewAppForm.controls.name.touched && addNewAppForm.controls.name.invalid, editMode: editAppMode }" />
				<label for="app-name">Enter App Name</label>
				<div class="input__error input__error__danger" *ngIf="addNewAppForm.controls.name.touched && addNewAppForm.controls.name.invalid">
					<img src="assets/img/input-error-icon.svg" alt="input error icon" />
					<span>App name is required</span>
				</div>
			</div>

			<div class="input">
				<input type="text" id="app-email" formControlName="support_email" [ngClass]="{ editMode: editAppMode }" />
				<label class="input__label" for="app-email">Support Email</label>
				<div class="input__error input__error__secondary font__12px">
					<img src="/assets/img/small-info-icon.svg" alt="close icon" />
					We use this to send an email notifcation for when a failure happens
				</div>
			</div>

			<div *ngIf="!editAppMode" formArrayName="endpoints">
				<div *ngIf="endpoints.controls.length > 0" class="flex flex__align-items-center flex__justify-between">
					<h3>Endpoint</h3>
					<button (click)="addEndpoint()" class="button__clear button--has-icon icon-left">
						<img src="/assets/img/add-icon.svg" alt="close icon" />
						Add Endpoint
					</button>
				</div>

				<div *ngFor="let endpoint of endpoints.controls; let i = index">
					<div [formGroupName]="i">
						<div class="input">
							<input type="text" formControlName="description" required />
							<label for="">Description</label>
							<div class="input__error input__error__danger" *ngIf="getSingleEndpoint(i).description.touched && getSingleEndpoint(i).description.invalid">
								<img src="assets/img/input-error-icon.svg" alt="input error icon" />
								<span>Please provide a description</span>
							</div>
						</div>

						<div class="input">
							<input type="text" formControlName="url" required />
							<label for="">Enter Endpoint URL</label>
							<div class="input__error input__error__danger" *ngIf="getSingleEndpoint(i).url.touched && getSingleEndpoint(i).url.invalid">
								<img src="assets/img/input-error-icon.svg" alt="input error icon" />
								<span>Please provide a description</span>
							</div>
						</div>

						<div class="input multiple">
							<div class="input--multiple" [ngClass]="{ active: eventTags.length > 0 }">
								<div class="tag" *ngFor="let tag of eventTags">
									{{ tag }}
									<a (click)="removeEventTag(tag)">
										<img src="/assets/img/close-icon-black.svg" alt="close icon" />
									</a>
								</div>
								<input type="text" id="tagInput" formControlName="tag" (input)="addTag($event, i)" required />
							</div>

							<label [ngClass]="{ active: eventTags.length > 0 }" for="">Add Tag</label>
							<div class="input__error input__error__secondary font__12px">
								<img src="/assets/img/small-info-icon.svg" alt="close icon" />
								Add multiple tags by seperating them with commas
							</div>

							<div class="input__error input__error__danger" *ngIf="getSingleEndpoint(i).tag.touched && getSingleEndpoint(i).tag.invalid">
								<img src="assets/img/input-error-icon.svg" alt="input error icon" />
								<span>Please add at least one tag</span>
							</div>
						</div>

						<div class="flex flex__justify-end margin-bottom__16px">
							<button (click)="removeEndpoint(i)" class="button__clear color__danger button--has-icon icon-left">
								<img src="/assets/img/trash-icon.svg" alt="close icon" />
								Remove Endpoint
							</button>
						</div>
					</div>
				</div>
				<!-- to be reviewed -->
				<!-- <div class="flex flex__justify-end" >
                    <button *ngIf="endpoints.controls.length == 0" (click)="addEndpoint()" class="button__clear button--has-icon icon-left margin-top__20px">
                        <img src="/assets/img/add-icon.svg" alt="close icon" />
                        Add Endpoint
                    </button>
                </div> -->
			</div>
		</form>
	</div>

	<div class="modal--footer modal--footer__with-shadow" *ngIf="showCreateAppModal">
		<button class="button button__white button--large" (click)="showCreateAppModal = false; editAppMode = false; addNewAppForm.reset()">Discard</button>
		<button id="create-app-button" class="button button__primary button--full-100 margin-left__24px" [disabled]="isCreatingNewApp" (click)="createNewApp()">
			{{ editAppMode ? 'Edit App' : 'Create App' }}
		</button>
	</div>

	<!-- add endpoint modal  -->
	<div class="modal--head" *ngIf="showAddEndpointModal">
		<h2>Add Endpoint</h2>
		<a (click)="showAddEndpointModal = false">
			<img src="/assets/img/modal-close-icon.svg" alt="close icon" />
		</a>
	</div>

	<div class="modal--body" *ngIf="showAddEndpointModal">
		<form [formGroup]="addNewEndpointForm">
			<div class="input">
				<input type="text" formControlName="description" [ngClass]="{ danger: addNewEndpointForm.controls.description.touched && addNewEndpointForm.controls.description.invalid }" required />
				<label for="">Description</label>
				<div class="input__error input__error__danger" *ngIf="addNewEndpointForm.controls.description.touched && addNewEndpointForm.controls.description.invalid">
					<img src="assets/img/input-error-icon.svg" alt="input error icon" />
					<span>Please provide a description</span>
				</div>
			</div>

			<div class="input">
				<input type="text" formControlName="url" [ngClass]="{ danger: addNewEndpointForm.controls.url.touched && addNewEndpointForm.controls.url.invalid }" required />
				<label for="">Enter URL</label>
				<div class="input__error input__error__danger" *ngIf="addNewEndpointForm.controls.url.touched && addNewEndpointForm.controls.url.invalid">
					<img src="assets/img/input-error-icon.svg" alt="input error icon" />
					<span>Endpoint URL is required</span>
				</div>
			</div>

			<div class="input multiple">
				<div class="input--multiple" [ngClass]="{ active: eventTags.length > 0 }">
					<div class="tag" *ngFor="let tag of eventTags">
						{{ tag }}
						<a (click)="removeEventTag(tag)">
							<img src="/assets/img/close-icon-black.svg" alt="close icon" />
						</a>
					</div>
					<input type="text" id="tagInput" (input)="addTag()" required />
				</div>

				<label [ngClass]="{ active: eventTags.length > 0 }" for="">Events</label>
				<div class="input__error input__error__secondary font__12px">
					<img src="/assets/img/small-info-icon.svg" alt="close icon" />
					Add multiple events by seperating them with commas
				</div>
			</div>
		</form>
	</div>

	<div class="modal--footer modal--footer__with-shadow" *ngIf="showAddEndpointModal">
		<button class="button button__white margin-right__24px" (click)="showAddEndpointModal = false">Discard</button>
		<button class="button button__primary button--full-100" [disabled]="isCreatingNewEndpoint" (click)="addNewEndpoint()">{{ isCreatingNewEndpoint ? 'Adding Endpoint..' : 'Add Endpoint' }}</button>
	</div>

	<!-- add event modal  -->
	<div class="modal--head" *ngIf="showAddEventModal">
		<h2>Add Event</h2>
		<a (click)="showAddEventModal = false">
			<img src="/assets/img/modal-close-icon.svg" alt="close icon" />
		</a>
	</div>

	<div class="modal--body" *ngIf="showAddEventModal">
		<form [formGroup]="sendEventForm">
			<div class="input">
				<select class="editMode" formControlName="app_id">
					<option *ngFor="let app of apps?.content" [value]="app.uid">{{ app.name }}</option>
				</select>
				<label for="">App ID</label>
				<div class="input__error input__error__danger" *ngIf="sendEventForm.controls.app_id.touched && sendEventForm.controls.app_id.invalid">
					<img src="assets/img/input-error-icon.svg" alt="input error icon" />
					<span>App Id is required</span>
				</div>
			</div>
			<div class="input">
				<textarea formControlName="data" required cols="5" [ngClass]="{ danger: sendEventForm.controls.data.touched && sendEventForm.controls.data.invalid }"></textarea>
				<label for="">Data</label>
				<div class="input__error input__error__danger" *ngIf="sendEventForm.controls.data.touched && sendEventForm.controls.data.invalid">
					<img src="assets/img/input-error-icon.svg" alt="input error icon" />
					<span>Data is required</span>
				</div>
				<div class="input__error input__error__secondary font__12px">
					<img src="/assets/img/small-info-icon.svg" alt="close icon" />
					Please enter your data in the format it would be returned
				</div>
			</div>
			<div class="input">
				<input type="text" formControlName="event_type" [ngClass]="{ danger: sendEventForm.controls.event_type.touched && sendEventForm.controls.event_type.invalid }" required />
				<label for="">Event Type</label>
				<div class="input__error input__error__danger" *ngIf="sendEventForm.controls.event_type.touched && sendEventForm.controls.event_type.invalid">
					<img src="assets/img/input-error-icon.svg" alt="input error icon" />
					<span>Event type is required</span>
				</div>
			</div>
		</form>
	</div>
	<div class="modal--footer modal--footer__with-shadow" *ngIf="showAddEventModal">
		<button class="button button__white margin-right__24px" (click)="showAddEventModal = false">Discard</button>
		<button class="button button__primary button--full-100" [disabled]="isSendingNewEvent" (click)="sendNewEvent()">{{ isSendingNewEvent ? 'Adding Event..' : 'Add Event' }}</button>
	</div>

	<!-- endpoint secret modal  -->
	<div class="modal--head" *ngIf="showEndpointSecret">
		<h2>Endpoint Secret</h2>
		<a (click)="showEndpointSecret = false">
			<img src="/assets/img/modal-close-icon.svg" alt="close icon" />
		</a>
	</div>
	<div class="modal--body" *ngIf="showEndpointSecret">
		<div class="key">
			<span>{{ endpointSecretKey }}</span>
			<button (click)="copyKey(endpointSecretKey, 'secret')">
				<img src="/assets/img/copy.svg" alt="copy" />
				<small *ngIf="showSecretCopyText">Copied!</small>
			</button>
		</div>
	</div>
</div>

<!-- delete app modal  -->
<div class="modal modal__center" *ngIf="showDeleteAppModal">
	<div class="modal--body flex flex__column flex__justify-center flex__align-items-center delete">
		<img src="/assets/img/warning.gif" class="img" alt="warning" />
		<p class="font__16px font__weight-600 color__black margin-bottom__8px">Are you sure you want to delete {{ appsDetailsItem?.name }}?</p>
		<p class="font__14px font__weight-500 color__grey margin-bottom__12px">This action is irrevesible</p>
		<button class="button button__deactivate margin-bottom__24px" [disabled]="isDeletingApp" (click)="deleteApp()">{{ isDeletingApp ? 'Deleting App...' : 'Yes, Delete' }}</button>
		<button class="button__primary button__clear font__weight-600 cancel" (click)="showDeleteAppModal = false">No, Cancel</button>
	</div>
</div>

<!-- batch retry modal  -->
<div class="modal modal__center" *ngIf="showBatchRetryModal">
	<div class="modal--body flex flex__column flex__justify-center flex__align-items-center delete">
		<img src="/assets/img/filter.gif" alt="filter icon" class="filter-img" />
		<div class="text-center font__20px font__weight-500 color__grey margin-bottom__8px">The filters applied will affect</div>
		<div class="text-center font__20px font__weight-600 color__black margin-bottom__32px">{{ batchRetryCount || 0 }} event{{ batchRetryCount > 1 ? 's' : '' }}</div>
		<button class="button button__primary" [disabled]="isRetyring || batchRetryCount == 0" (click)="batchRetryEvent()">{{ isRetyring ? 'Retrying Events...' : 'Yes, Apply' }}</button>
		<button class="button__primary button__clear margin-top__28px font__weight-600" (click)="showBatchRetryModal = false">No, Cancel</button>
	</div>
</div>

<!-- projects modal  -->
<div class="modal modal__center projects-modal width-unset-max" *ngIf="showProjectsModal">
	<div class="modal--body padding-all__40px">
		<h3 class="margin-bottom__8px">Select a project</h3>
		<p class="margin-bottom__32px color__grey font__14px">All your project's summary at a glance</p>
		<button class="close rounded__6px padding-all__10px border--none flex" *ngIf="convyDashboardService.activeGroupId" (click)="showProjectsModal = false">
			<img src="/assets/img/close-icon-grey.svg" alt="close icon" />
		</button>

		<ul class="grid grid__col-3--smaller" *ngIf="isLoadingProjects">
			<li *ngFor="let index of groupsLoaderIndex">
				<div class="card rounded__8px border__all bg__white">
					<div class="padding-x__24px padding-top__24px padding-bottom__14px border__bottom">
						<div class="skeleton-loader header"></div>
					</div>
					<div class="flex flex__align-items-center border__bottom">
						<div class="border__right padding-y__8px width__50 padding-x__24px">
							<div class="skeleton-loader text"></div>
						</div>
						<div class="flex flex__align-items-center flex__justify-between width__50 padding-y__8px padding-x__24px">
							<div>
								<div class="skeleton-loader small"></div>
							</div>
							<div><div class="skeleton-loader small"></div></div>
						</div>
					</div>
					<div class="pointer-cursor padding-all__16px overflow--hidden">
						<div class="skeleton-loader img"></div>
					</div>
				</div>
			</li>
		</ul>

		<ul class="grid grid__col-3--smaller" *ngIf="!isLoadingProjects">
			<li *ngFor="let group of groups" (click)="convyDashboardService.activeGroupId = group.uid; toggleActiveGroup(); showProjectsModal = false">
				<div class="card rounded__8px border__all bg__white">
					<div class="padding-x__24px padding-top__24px padding-bottom__14px border__bottom">
						<h4 class="pointer-cursor">{{ group.name }}</h4>
					</div>

					<div class="flex flex__align-items-center flex__justify-between border__bottom">
						<div class="font__12px font__weight-500 color__grey width__50 border__right padding-y__8px padding-x__12px">
							<span class="color__black margin-right__8px">{{ group?.statistics?.messages_sent }}</span>
							Events Sent
						</div>

						<div class="flex flex__align-items-center flex__justify-between width__50 padding-y__8px padding-x__12px">
							<div class="font__12px font__weight-500 color__grey">
								<span class="color__black margin-right__8px">{{ group?.statistics?.total_apps }}</span>
								Apps
							</div>

							<!-- Pending when API is ready -->
							<!-- <div class="dropdown">
								<button class="button__clear" (click)="group.showDropdown = !group.showDropdown">
									<img src="/assets/img/more-horizontal.svg" alt="more" />
								</button>

								<div class="dropdown__menu dropdown__menu__nav large" [ngClass]="{ show: group.showDropdown }">
									<ul>
										<li>
											<p>View Project</p>
										</li>
										<li>
											<p>Project settings</p>
										</li>
										<li class="danger">
											<p>Delete Project</p>
										</li>
									</ul>
								</div>
							</div> -->
						</div>
					</div>
					<div class="pointer-cursor padding-top__16px overflow--hidden">
						<img src="/assets/img/chart-icon.svg" alt="graph icon" />
					</div>
				</div>
			</li>
		</ul>
	</div>
</div>
